var Ou=Object.create;var Xt=Object.defineProperty,Lu=Object.defineProperties,Du=Object.getOwnPropertyDescriptor,Wu=Object.getOwnPropertyDescriptors,Iu=Object.getOwnPropertyNames,Js=Object.getOwnPropertySymbols,Fu=Object.getPrototypeOf,Zs=Object.prototype.hasOwnProperty,qu=Object.prototype.propertyIsEnumerable;var Ks=(o,t,n)=>t in o?Xt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,X=(o,t)=>{for(var n in t||(t={}))Zs.call(t,n)&&Ks(o,n,t[n]);if(Js)for(var n of Js(t))qu.call(t,n)&&Ks(o,n,t[n]);return o},Ee=(o,t)=>Lu(o,Wu(t)),ei=o=>Xt(o,"__esModule",{value:!0});var Jt=(o,t)=>()=>(o&&(t=o(o=0)),t);var H=(o,t)=>()=>(t||o((t={exports:{}}).exports,t),t.exports),ti=(o,t)=>{for(var n in t)Xt(o,n,{get:t[n],enumerable:!0})},ri=(o,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Iu(t))!Zs.call(o,a)&&(n||a!=="default")&&Xt(o,a,{get:()=>t[a],enumerable:!(s=Du(t,a))||s.enumerable});return o},rt=(o,t)=>ri(ei(Xt(o!=null?Ou(Fu(o)):{},"default",!t&&o&&o.__esModule?{get:()=>o.default,enumerable:!0}:{value:o,enumerable:!0})),o),Nu=(o=>(t,n)=>o&&o.get(t)||(n=ri(ei({}),t,1),o&&o.set(t,n),n))(typeof WeakMap!="undefined"?new WeakMap:0);var si=H((Jr,oi)=>{(function(o,t){typeof Jr=="object"&&typeof oi<"u"?t(Jr):typeof define=="function"&&define.amd?define(["exports"],t):(o=typeof globalThis<"u"?globalThis:o||self,t(o.WebStreamsPolyfill={}))})(Jr,function(o){"use strict";let t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol:e=>`Symbol(${e})`;function n(){}function s(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global}let a=s();function l(e){return typeof e=="object"&&e!==null||typeof e=="function"}let f=n,m=Promise,d=Promise.prototype.then,h=Promise.resolve.bind(m),b=Promise.reject.bind(m);function g(e){return new m(e)}function w(e){return h(e)}function S(e){return b(e)}function y(e,r,i){return d.call(e,r,i)}function T(e,r,i){y(y(e,r,i),void 0,f)}function P(e,r){T(e,r)}function A(e,r){T(e,void 0,r)}function D(e,r,i){return y(e,r,i)}function N(e){y(e,void 0,f)}let W=(()=>{let e=a&&a.queueMicrotask;if(typeof e=="function")return e;let r=w(void 0);return i=>y(r,i)})();function M(e,r,i){if(typeof e!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,r,i)}function I(e,r,i){try{return w(M(e,r,i))}catch(u){return S(u)}}let le=16384;class V{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(r){let i=this._back,u=i;i._elements.length===le-1&&(u={_elements:[],_next:void 0}),i._elements.push(r),u!==i&&(this._back=u,i._next=u),++this._size}shift(){let r=this._front,i=r,u=this._cursor,c=u+1,p=r._elements,_=p[u];return c===le&&(i=r._next,c=0),--this._size,this._cursor=c,r!==i&&(this._front=i),p[u]=void 0,_}forEach(r){let i=this._cursor,u=this._front,c=u._elements;for(;(i!==c.length||u._next!==void 0)&&!(i===c.length&&(u=u._next,c=u._elements,i=0,c.length===0));)r(c[i]),++i}peek(){let r=this._front,i=this._cursor;return r._elements[i]}}function yr(e,r){e._ownerReadableStream=r,r._reader=e,r._state==="readable"?wn(e):r._state==="closed"?al(e):Fo(e,r._storedError)}function Sn(e,r){let i=e._ownerReadableStream;return ce(i,r)}function ge(e){e._ownerReadableStream._state==="readable"?Rn(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):ll(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function ct(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function wn(e){e._closedPromise=g((r,i)=>{e._closedPromise_resolve=r,e._closedPromise_reject=i})}function Fo(e,r){wn(e),Rn(e,r)}function al(e){wn(e),qo(e)}function Rn(e,r){e._closedPromise_reject!==void 0&&(N(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function ll(e,r){Fo(e,r)}function qo(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}let No=t("[[AbortSteps]]"),Mo=t("[[ErrorSteps]]"),Tn=t("[[CancelSteps]]"),En=t("[[PullSteps]]"),Uo=Number.isFinite||function(e){return typeof e=="number"&&isFinite(e)},ul=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function fl(e){return typeof e=="object"||typeof e=="function"}function Se(e,r){if(e!==void 0&&!fl(e))throw new TypeError(`${r} is not an object.`)}function ue(e,r){if(typeof e!="function")throw new TypeError(`${r} is not a function.`)}function cl(e){return typeof e=="object"&&e!==null||typeof e=="function"}function $o(e,r){if(!cl(e))throw new TypeError(`${r} is not an object.`)}function we(e,r,i){if(e===void 0)throw new TypeError(`Parameter ${r} is required in '${i}'.`)}function Cn(e,r,i){if(e===void 0)throw new TypeError(`${r} is required in '${i}'.`)}function Pn(e){return Number(e)}function zo(e){return e===0?0:e}function dl(e){return zo(ul(e))}function jo(e,r){let u=Number.MAX_SAFE_INTEGER,c=Number(e);if(c=zo(c),!Uo(c))throw new TypeError(`${r} is not a finite number`);if(c=dl(c),c<0||c>u)throw new TypeError(`${r} is outside the accepted range of ${0} to ${u}, inclusive`);return!Uo(c)||c===0?0:c}function vn(e,r){if(!Ie(e))throw new TypeError(`${r} is not a ReadableStream.`)}function dt(e){return new Wt(e)}function Ho(e,r){e._reader._readRequests.push(r)}function An(e,r,i){let c=e._reader._readRequests.shift();i?c._closeSteps():c._chunkSteps(r)}function gr(e){return e._reader._readRequests.length}function Go(e){let r=e._reader;return!(r===void 0||!Oe(r))}class Wt{constructor(r){if(we(r,1,"ReadableStreamDefaultReader"),vn(r,"First parameter"),Fe(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");yr(this,r),this._readRequests=new V}get closed(){return Oe(this)?this._closedPromise:S(Sr("closed"))}cancel(r=void 0){return Oe(this)?this._ownerReadableStream===void 0?S(ct("cancel")):Sn(this,r):S(Sr("cancel"))}read(){if(!Oe(this))return S(Sr("read"));if(this._ownerReadableStream===void 0)return S(ct("read from"));let r,i,u=g((p,_)=>{r=p,i=_});return It(this,{_chunkSteps:p=>r({value:p,done:!1}),_closeSteps:()=>r({value:void 0,done:!0}),_errorSteps:p=>i(p)}),u}releaseLock(){if(!Oe(this))throw Sr("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ge(this)}}}Object.defineProperties(Wt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Wt.prototype,t.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});function Oe(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readRequests")?!1:e instanceof Wt}function It(e,r){let i=e._ownerReadableStream;i._disturbed=!0,i._state==="closed"?r._closeSteps():i._state==="errored"?r._errorSteps(i._storedError):i._readableStreamController[En](r)}function Sr(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let Vo=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class Yo{constructor(r,i){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=r,this._preventCancel=i}next(){let r=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?D(this._ongoingPromise,r,r):r(),this._ongoingPromise}return(r){let i=()=>this._returnSteps(r);return this._ongoingPromise?D(this._ongoingPromise,i,i):i()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});let r=this._reader;if(r._ownerReadableStream===void 0)return S(ct("iterate"));let i,u,c=g((_,R)=>{i=_,u=R});return It(r,{_chunkSteps:_=>{this._ongoingPromise=void 0,W(()=>i({value:_,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,ge(r),i({value:void 0,done:!0})},_errorSteps:_=>{this._ongoingPromise=void 0,this._isFinished=!0,ge(r),u(_)}}),c}_returnSteps(r){if(this._isFinished)return Promise.resolve({value:r,done:!0});this._isFinished=!0;let i=this._reader;if(i._ownerReadableStream===void 0)return S(ct("finish iterating"));if(!this._preventCancel){let u=Sn(i,r);return ge(i),D(u,()=>({value:r,done:!0}))}return ge(i),w({value:r,done:!0})}}let Qo={next(){return Xo(this)?this._asyncIteratorImpl.next():S(Jo("next"))},return(e){return Xo(this)?this._asyncIteratorImpl.return(e):S(Jo("return"))}};Vo!==void 0&&Object.setPrototypeOf(Qo,Vo);function hl(e,r){let i=dt(e),u=new Yo(i,r),c=Object.create(Qo);return c._asyncIteratorImpl=u,c}function Xo(e){if(!l(e)||!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Yo}catch{return!1}}function Jo(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}let Ko=Number.isNaN||function(e){return e!==e};function Ft(e){return e.slice()}function Zo(e,r,i,u,c){new Uint8Array(e).set(new Uint8Array(i,u,c),r)}function kc(e){return e}function wr(e){return!1}function es(e,r,i){if(e.slice)return e.slice(r,i);let u=i-r,c=new ArrayBuffer(u);return Zo(c,0,e,r,u),c}function ml(e){return!(typeof e!="number"||Ko(e)||e<0)}function ts(e){let r=es(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(r)}function kn(e){let r=e._queue.shift();return e._queueTotalSize-=r.size,e._queueTotalSize<0&&(e._queueTotalSize=0),r.value}function xn(e,r,i){if(!ml(i)||i===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:r,size:i}),e._queueTotalSize+=i}function pl(e){return e._queue.peek().value}function Le(e){e._queue=new V,e._queueTotalSize=0}class qt{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Bn(this))throw Wn("view");return this._view}respond(r){if(!Bn(this))throw Wn("respond");if(we(r,1,"respond"),r=jo(r,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");wr(this._view.buffer),Pr(this._associatedReadableByteStreamController,r)}respondWithNewView(r){if(!Bn(this))throw Wn("respondWithNewView");if(we(r,1,"respondWithNewView"),!ArrayBuffer.isView(r))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");wr(r.buffer),vr(this._associatedReadableByteStreamController,r)}}Object.defineProperties(qt.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(qt.prototype,t.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class ht{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!Xe(this))throw Mt("byobRequest");return Dn(this)}get desiredSize(){if(!Xe(this))throw Mt("desiredSize");return us(this)}close(){if(!Xe(this))throw Mt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");let r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be closed`);Nt(this)}enqueue(r){if(!Xe(this))throw Mt("enqueue");if(we(r,1,"enqueue"),!ArrayBuffer.isView(r))throw new TypeError("chunk must be an array buffer view");if(r.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(r.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");let i=this._controlledReadableByteStream._state;if(i!=="readable")throw new TypeError(`The stream (in ${i} state) is not in the readable state and cannot be enqueued to`);Cr(this,r)}error(r=void 0){if(!Xe(this))throw Mt("error");fe(this,r)}[Tn](r){rs(this),Le(this);let i=this._cancelAlgorithm(r);return Er(this),i}[En](r){let i=this._controlledReadableByteStream;if(this._queueTotalSize>0){let c=this._queue.shift();this._queueTotalSize-=c.byteLength,is(this);let p=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);r._chunkSteps(p);return}let u=this._autoAllocateChunkSize;if(u!==void 0){let c;try{c=new ArrayBuffer(u)}catch(_){r._errorSteps(_);return}let p={buffer:c,bufferByteLength:u,byteOffset:0,byteLength:u,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(p)}Ho(i,r),Je(this)}}Object.defineProperties(ht.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(ht.prototype,t.toStringTag,{value:"ReadableByteStreamController",configurable:!0});function Xe(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")?!1:e instanceof ht}function Bn(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")?!1:e instanceof qt}function Je(e){if(!gl(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();T(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Je(e))},u=>{fe(e,u)})}function rs(e){Ln(e),e._pendingPullIntos=new V}function On(e,r){let i=!1;e._state==="closed"&&(i=!0);let u=ns(r);r.readerType==="default"?An(e,u,i):Rl(e,u,i)}function ns(e){let r=e.bytesFilled,i=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,r/i)}function Rr(e,r,i,u){e._queue.push({buffer:r,byteOffset:i,byteLength:u}),e._queueTotalSize+=u}function os(e,r){let i=r.elementSize,u=r.bytesFilled-r.bytesFilled%i,c=Math.min(e._queueTotalSize,r.byteLength-r.bytesFilled),p=r.bytesFilled+c,_=p-p%i,R=c,k=!1;_>u&&(R=_-r.bytesFilled,k=!0);let B=e._queue;for(;R>0;){let O=B.peek(),L=Math.min(R,O.byteLength),U=r.byteOffset+r.bytesFilled;Zo(r.buffer,U,O.buffer,O.byteOffset,L),O.byteLength===L?B.shift():(O.byteOffset+=L,O.byteLength-=L),e._queueTotalSize-=L,ss(e,L,r),R-=L}return k}function ss(e,r,i){i.bytesFilled+=r}function is(e){e._queueTotalSize===0&&e._closeRequested?(Er(e),Yt(e._controlledReadableByteStream)):Je(e)}function Ln(e){e._byobRequest!==null&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function as(e){for(;e._pendingPullIntos.length>0;){if(e._queueTotalSize===0)return;let r=e._pendingPullIntos.peek();os(e,r)&&(Tr(e),On(e._controlledReadableByteStream,r))}}function _l(e,r,i){let u=e._controlledReadableByteStream,c=1;r.constructor!==DataView&&(c=r.constructor.BYTES_PER_ELEMENT);let p=r.constructor,_=r.buffer,R={buffer:_,bufferByteLength:_.byteLength,byteOffset:r.byteOffset,byteLength:r.byteLength,bytesFilled:0,elementSize:c,viewConstructor:p,readerType:"byob"};if(e._pendingPullIntos.length>0){e._pendingPullIntos.push(R),ds(u,i);return}if(u._state==="closed"){let k=new p(R.buffer,R.byteOffset,0);i._closeSteps(k);return}if(e._queueTotalSize>0){if(os(e,R)){let k=ns(R);is(e),i._chunkSteps(k);return}if(e._closeRequested){let k=new TypeError("Insufficient bytes to fill elements in the given buffer");fe(e,k),i._errorSteps(k);return}}e._pendingPullIntos.push(R),ds(u,i),Je(e)}function bl(e,r){let i=e._controlledReadableByteStream;if(In(i))for(;hs(i)>0;){let u=Tr(e);On(i,u)}}function yl(e,r,i){if(ss(e,r,i),i.bytesFilled<i.elementSize)return;Tr(e);let u=i.bytesFilled%i.elementSize;if(u>0){let c=i.byteOffset+i.bytesFilled,p=es(i.buffer,c-u,c);Rr(e,p,0,p.byteLength)}i.bytesFilled-=u,On(e._controlledReadableByteStream,i),as(e)}function ls(e,r){let i=e._pendingPullIntos.peek();Ln(e),e._controlledReadableByteStream._state==="closed"?bl(e):yl(e,r,i),Je(e)}function Tr(e){return e._pendingPullIntos.shift()}function gl(e){let r=e._controlledReadableByteStream;return r._state!=="readable"||e._closeRequested||!e._started?!1:!!(Go(r)&&gr(r)>0||In(r)&&hs(r)>0||us(e)>0)}function Er(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Nt(e){let r=e._controlledReadableByteStream;if(!(e._closeRequested||r._state!=="readable")){if(e._queueTotalSize>0){e._closeRequested=!0;return}if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){let u=new TypeError("Insufficient bytes to fill elements in the given buffer");throw fe(e,u),u}Er(e),Yt(r)}}function Cr(e,r){let i=e._controlledReadableByteStream;if(e._closeRequested||i._state!=="readable")return;let u=r.buffer,c=r.byteOffset,p=r.byteLength,_=u;if(e._pendingPullIntos.length>0){let R=e._pendingPullIntos.peek();wr(R.buffer),R.buffer=R.buffer}if(Ln(e),Go(i))if(gr(i)===0)Rr(e,_,c,p);else{e._pendingPullIntos.length>0&&Tr(e);let R=new Uint8Array(_,c,p);An(i,R,!1)}else In(i)?(Rr(e,_,c,p),as(e)):Rr(e,_,c,p);Je(e)}function fe(e,r){let i=e._controlledReadableByteStream;i._state==="readable"&&(rs(e),Le(e),Er(e),Fs(i,r))}function Dn(e){if(e._byobRequest===null&&e._pendingPullIntos.length>0){let r=e._pendingPullIntos.peek(),i=new Uint8Array(r.buffer,r.byteOffset+r.bytesFilled,r.byteLength-r.bytesFilled),u=Object.create(qt.prototype);wl(u,e,i),e._byobRequest=u}return e._byobRequest}function us(e){let r=e._controlledReadableByteStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function Pr(e,r){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(r===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(i.bytesFilled+r>i.byteLength)throw new RangeError("bytesWritten out of range")}i.buffer=i.buffer,ls(e,r)}function vr(e,r){let i=e._pendingPullIntos.peek();if(e._controlledReadableByteStream._state==="closed"){if(r.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(r.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(i.byteOffset+i.bytesFilled!==r.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(i.bufferByteLength!==r.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(i.bytesFilled+r.byteLength>i.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");let c=r.byteLength;i.buffer=r.buffer,ls(e,c)}function fs(e,r,i,u,c,p,_){r._controlledReadableByteStream=e,r._pullAgain=!1,r._pulling=!1,r._byobRequest=null,r._queue=r._queueTotalSize=void 0,Le(r),r._closeRequested=!1,r._started=!1,r._strategyHWM=p,r._pullAlgorithm=u,r._cancelAlgorithm=c,r._autoAllocateChunkSize=_,r._pendingPullIntos=new V,e._readableStreamController=r;let R=i();T(w(R),()=>{r._started=!0,Je(r)},k=>{fe(r,k)})}function Sl(e,r,i){let u=Object.create(ht.prototype),c=()=>{},p=()=>w(void 0),_=()=>w(void 0);r.start!==void 0&&(c=()=>r.start(u)),r.pull!==void 0&&(p=()=>r.pull(u)),r.cancel!==void 0&&(_=k=>r.cancel(k));let R=r.autoAllocateChunkSize;if(R===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");fs(e,u,c,p,_,i,R)}function wl(e,r,i){e._associatedReadableByteStreamController=r,e._view=i}function Wn(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Mt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function cs(e){return new Ut(e)}function ds(e,r){e._reader._readIntoRequests.push(r)}function Rl(e,r,i){let c=e._reader._readIntoRequests.shift();i?c._closeSteps(r):c._chunkSteps(r)}function hs(e){return e._reader._readIntoRequests.length}function In(e){let r=e._reader;return!(r===void 0||!Ke(r))}class Ut{constructor(r){if(we(r,1,"ReadableStreamBYOBReader"),vn(r,"First parameter"),Fe(r))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!Xe(r._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");yr(this,r),this._readIntoRequests=new V}get closed(){return Ke(this)?this._closedPromise:S(Ar("closed"))}cancel(r=void 0){return Ke(this)?this._ownerReadableStream===void 0?S(ct("cancel")):Sn(this,r):S(Ar("cancel"))}read(r){if(!Ke(this))return S(Ar("read"));if(!ArrayBuffer.isView(r))return S(new TypeError("view must be an array buffer view"));if(r.byteLength===0)return S(new TypeError("view must have non-zero byteLength"));if(r.buffer.byteLength===0)return S(new TypeError("view's buffer must have non-zero byteLength"));if(wr(r.buffer),this._ownerReadableStream===void 0)return S(ct("read from"));let i,u,c=g((_,R)=>{i=_,u=R});return ms(this,r,{_chunkSteps:_=>i({value:_,done:!1}),_closeSteps:_=>i({value:_,done:!0}),_errorSteps:_=>u(_)}),c}releaseLock(){if(!Ke(this))throw Ar("releaseLock");if(this._ownerReadableStream!==void 0){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ge(this)}}}Object.defineProperties(Ut.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Ut.prototype,t.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});function Ke(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")?!1:e instanceof Ut}function ms(e,r,i){let u=e._ownerReadableStream;u._disturbed=!0,u._state==="errored"?i._errorSteps(u._storedError):_l(u._readableStreamController,r,i)}function Ar(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function $t(e,r){let{highWaterMark:i}=e;if(i===void 0)return r;if(Ko(i)||i<0)throw new RangeError("Invalid highWaterMark");return i}function kr(e){let{size:r}=e;return r||(()=>1)}function xr(e,r){Se(e,r);let i=e==null?void 0:e.highWaterMark,u=e==null?void 0:e.size;return{highWaterMark:i===void 0?void 0:Pn(i),size:u===void 0?void 0:Tl(u,`${r} has member 'size' that`)}}function Tl(e,r){return ue(e,r),i=>Pn(e(i))}function El(e,r){Se(e,r);let i=e==null?void 0:e.abort,u=e==null?void 0:e.close,c=e==null?void 0:e.start,p=e==null?void 0:e.type,_=e==null?void 0:e.write;return{abort:i===void 0?void 0:Cl(i,e,`${r} has member 'abort' that`),close:u===void 0?void 0:Pl(u,e,`${r} has member 'close' that`),start:c===void 0?void 0:vl(c,e,`${r} has member 'start' that`),write:_===void 0?void 0:Al(_,e,`${r} has member 'write' that`),type:p}}function Cl(e,r,i){return ue(e,i),u=>I(e,r,[u])}function Pl(e,r,i){return ue(e,i),()=>I(e,r,[])}function vl(e,r,i){return ue(e,i),u=>M(e,r,[u])}function Al(e,r,i){return ue(e,i),(u,c)=>I(e,r,[u,c])}function ps(e,r){if(!mt(e))throw new TypeError(`${r} is not a WritableStream.`)}function kl(e){if(typeof e!="object"||e===null)return!1;try{return typeof e.aborted=="boolean"}catch{return!1}}let xl=typeof AbortController=="function";function Bl(){if(xl)return new AbortController}class zt{constructor(r={},i={}){r===void 0?r=null:$o(r,"First parameter");let u=xr(i,"Second parameter"),c=El(r,"First parameter");if(bs(this),c.type!==void 0)throw new RangeError("Invalid type is specified");let _=kr(u),R=$t(u,1);Hl(this,c,R,_)}get locked(){if(!mt(this))throw Wr("locked");return pt(this)}abort(r=void 0){return mt(this)?pt(this)?S(new TypeError("Cannot abort a stream that already has a writer")):Br(this,r):S(Wr("abort"))}close(){return mt(this)?pt(this)?S(new TypeError("Cannot close a stream that already has a writer")):pe(this)?S(new TypeError("Cannot close an already-closing stream")):ys(this):S(Wr("close"))}getWriter(){if(!mt(this))throw Wr("getWriter");return _s(this)}}Object.defineProperties(zt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(zt.prototype,t.toStringTag,{value:"WritableStream",configurable:!0});function _s(e){return new jt(e)}function Ol(e,r,i,u,c=1,p=()=>1){let _=Object.create(zt.prototype);bs(_);let R=Object.create(_t.prototype);return Es(_,R,e,r,i,u,c,p),_}function bs(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new V,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function mt(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")?!1:e instanceof zt}function pt(e){return e._writer!==void 0}function Br(e,r){var i;if(e._state==="closed"||e._state==="errored")return w(void 0);e._writableStreamController._abortReason=r,(i=e._writableStreamController._abortController)===null||i===void 0||i.abort();let u=e._state;if(u==="closed"||u==="errored")return w(void 0);if(e._pendingAbortRequest!==void 0)return e._pendingAbortRequest._promise;let c=!1;u==="erroring"&&(c=!0,r=void 0);let p=g((_,R)=>{e._pendingAbortRequest={_promise:void 0,_resolve:_,_reject:R,_reason:r,_wasAlreadyErroring:c}});return e._pendingAbortRequest._promise=p,c||qn(e,r),p}function ys(e){let r=e._state;if(r==="closed"||r==="errored")return S(new TypeError(`The stream (in ${r} state) is not in the writable state and cannot be closed`));let i=g((c,p)=>{let _={_resolve:c,_reject:p};e._closeRequest=_}),u=e._writer;return u!==void 0&&e._backpressure&&r==="writable"&&Vn(u),Gl(e._writableStreamController),i}function Ll(e){return g((i,u)=>{let c={_resolve:i,_reject:u};e._writeRequests.push(c)})}function Fn(e,r){if(e._state==="writable"){qn(e,r);return}Nn(e)}function qn(e,r){let i=e._writableStreamController;e._state="erroring",e._storedError=r;let u=e._writer;u!==void 0&&Ss(u,r),!ql(e)&&i._started&&Nn(e)}function Nn(e){e._state="errored",e._writableStreamController[Mo]();let r=e._storedError;if(e._writeRequests.forEach(c=>{c._reject(r)}),e._writeRequests=new V,e._pendingAbortRequest===void 0){Or(e);return}let i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,i._wasAlreadyErroring){i._reject(r),Or(e);return}let u=e._writableStreamController[No](i._reason);T(u,()=>{i._resolve(),Or(e)},c=>{i._reject(c),Or(e)})}function Dl(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Wl(e,r){e._inFlightWriteRequest._reject(r),e._inFlightWriteRequest=void 0,Fn(e,r)}function Il(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,e._state==="erroring"&&(e._storedError=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";let i=e._writer;i!==void 0&&As(i)}function Fl(e,r){e._inFlightCloseRequest._reject(r),e._inFlightCloseRequest=void 0,e._pendingAbortRequest!==void 0&&(e._pendingAbortRequest._reject(r),e._pendingAbortRequest=void 0),Fn(e,r)}function pe(e){return!(e._closeRequest===void 0&&e._inFlightCloseRequest===void 0)}function ql(e){return!(e._inFlightWriteRequest===void 0&&e._inFlightCloseRequest===void 0)}function Nl(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Ml(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Or(e){e._closeRequest!==void 0&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);let r=e._writer;r!==void 0&&Hn(r,e._storedError)}function Mn(e,r){let i=e._writer;i!==void 0&&r!==e._backpressure&&(r?Zl(i):Vn(i)),e._backpressure=r}class jt{constructor(r){if(we(r,1,"WritableStreamDefaultWriter"),ps(r,"First parameter"),pt(r))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=r,r._writer=this;let i=r._state;if(i==="writable")!pe(r)&&r._backpressure?Fr(this):ks(this),Ir(this);else if(i==="erroring")Gn(this,r._storedError),Ir(this);else if(i==="closed")ks(this),Jl(this);else{let u=r._storedError;Gn(this,u),vs(this,u)}}get closed(){return Ze(this)?this._closedPromise:S(et("closed"))}get desiredSize(){if(!Ze(this))throw et("desiredSize");if(this._ownerWritableStream===void 0)throw Ht("desiredSize");return jl(this)}get ready(){return Ze(this)?this._readyPromise:S(et("ready"))}abort(r=void 0){return Ze(this)?this._ownerWritableStream===void 0?S(Ht("abort")):Ul(this,r):S(et("abort"))}close(){if(!Ze(this))return S(et("close"));let r=this._ownerWritableStream;return r===void 0?S(Ht("close")):pe(r)?S(new TypeError("Cannot close an already-closing stream")):gs(this)}releaseLock(){if(!Ze(this))throw et("releaseLock");this._ownerWritableStream!==void 0&&ws(this)}write(r=void 0){return Ze(this)?this._ownerWritableStream===void 0?S(Ht("write to")):Rs(this,r):S(et("write"))}}Object.defineProperties(jt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(jt.prototype,t.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});function Ze(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")?!1:e instanceof jt}function Ul(e,r){let i=e._ownerWritableStream;return Br(i,r)}function gs(e){let r=e._ownerWritableStream;return ys(r)}function $l(e){let r=e._ownerWritableStream,i=r._state;return pe(r)||i==="closed"?w(void 0):i==="errored"?S(r._storedError):gs(e)}function zl(e,r){e._closedPromiseState==="pending"?Hn(e,r):Kl(e,r)}function Ss(e,r){e._readyPromiseState==="pending"?xs(e,r):eu(e,r)}function jl(e){let r=e._ownerWritableStream,i=r._state;return i==="errored"||i==="erroring"?null:i==="closed"?0:Cs(r._writableStreamController)}function ws(e){let r=e._ownerWritableStream,i=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Ss(e,i),zl(e,i),r._writer=void 0,e._ownerWritableStream=void 0}function Rs(e,r){let i=e._ownerWritableStream,u=i._writableStreamController,c=Vl(u,r);if(i!==e._ownerWritableStream)return S(Ht("write to"));let p=i._state;if(p==="errored")return S(i._storedError);if(pe(i)||p==="closed")return S(new TypeError("The stream is closing or closed and cannot be written to"));if(p==="erroring")return S(i._storedError);let _=Ll(i);return Yl(u,r,c),_}let Ts={};class _t{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Un(this))throw jn("abortReason");return this._abortReason}get signal(){if(!Un(this))throw jn("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(r=void 0){if(!Un(this))throw jn("error");this._controlledWritableStream._state==="writable"&&Ps(this,r)}[No](r){let i=this._abortAlgorithm(r);return Lr(this),i}[Mo](){Le(this)}}Object.defineProperties(_t.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(_t.prototype,t.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});function Un(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")?!1:e instanceof _t}function Es(e,r,i,u,c,p,_,R){r._controlledWritableStream=e,e._writableStreamController=r,r._queue=void 0,r._queueTotalSize=void 0,Le(r),r._abortReason=void 0,r._abortController=Bl(),r._started=!1,r._strategySizeAlgorithm=R,r._strategyHWM=_,r._writeAlgorithm=u,r._closeAlgorithm=c,r._abortAlgorithm=p;let k=zn(r);Mn(e,k);let B=i(),O=w(B);T(O,()=>{r._started=!0,Dr(r)},L=>{r._started=!0,Fn(e,L)})}function Hl(e,r,i,u){let c=Object.create(_t.prototype),p=()=>{},_=()=>w(void 0),R=()=>w(void 0),k=()=>w(void 0);r.start!==void 0&&(p=()=>r.start(c)),r.write!==void 0&&(_=B=>r.write(B,c)),r.close!==void 0&&(R=()=>r.close()),r.abort!==void 0&&(k=B=>r.abort(B)),Es(e,c,p,_,R,k,i,u)}function Lr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Gl(e){xn(e,Ts,0),Dr(e)}function Vl(e,r){try{return e._strategySizeAlgorithm(r)}catch(i){return $n(e,i),1}}function Cs(e){return e._strategyHWM-e._queueTotalSize}function Yl(e,r,i){try{xn(e,r,i)}catch(c){$n(e,c);return}let u=e._controlledWritableStream;if(!pe(u)&&u._state==="writable"){let c=zn(e);Mn(u,c)}Dr(e)}function Dr(e){let r=e._controlledWritableStream;if(!e._started||r._inFlightWriteRequest!==void 0)return;if(r._state==="erroring"){Nn(r);return}if(e._queue.length===0)return;let u=pl(e);u===Ts?Ql(e):Xl(e,u)}function $n(e,r){e._controlledWritableStream._state==="writable"&&Ps(e,r)}function Ql(e){let r=e._controlledWritableStream;Nl(r),kn(e);let i=e._closeAlgorithm();Lr(e),T(i,()=>{Il(r)},u=>{Fl(r,u)})}function Xl(e,r){let i=e._controlledWritableStream;Ml(i);let u=e._writeAlgorithm(r);T(u,()=>{Dl(i);let c=i._state;if(kn(e),!pe(i)&&c==="writable"){let p=zn(e);Mn(i,p)}Dr(e)},c=>{i._state==="writable"&&Lr(e),Wl(i,c)})}function zn(e){return Cs(e)<=0}function Ps(e,r){let i=e._controlledWritableStream;Lr(e),qn(i,r)}function Wr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function jn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function et(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Ht(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Ir(e){e._closedPromise=g((r,i)=>{e._closedPromise_resolve=r,e._closedPromise_reject=i,e._closedPromiseState="pending"})}function vs(e,r){Ir(e),Hn(e,r)}function Jl(e){Ir(e),As(e)}function Hn(e,r){e._closedPromise_reject!==void 0&&(N(e._closedPromise),e._closedPromise_reject(r),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Kl(e,r){vs(e,r)}function As(e){e._closedPromise_resolve!==void 0&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function Fr(e){e._readyPromise=g((r,i)=>{e._readyPromise_resolve=r,e._readyPromise_reject=i}),e._readyPromiseState="pending"}function Gn(e,r){Fr(e),xs(e,r)}function ks(e){Fr(e),Vn(e)}function xs(e,r){e._readyPromise_reject!==void 0&&(N(e._readyPromise),e._readyPromise_reject(r),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function Zl(e){Fr(e)}function eu(e,r){Gn(e,r)}function Vn(e){e._readyPromise_resolve!==void 0&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}let Bs=typeof DOMException<"u"?DOMException:void 0;function tu(e){if(!(typeof e=="function"||typeof e=="object"))return!1;try{return new e,!0}catch{return!1}}function ru(){let e=function(i,u){this.message=i||"",this.name=u||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}let nu=tu(Bs)?Bs:ru();function Os(e,r,i,u,c,p){let _=dt(e),R=_s(r);e._disturbed=!0;let k=!1,B=w(void 0);return g((O,L)=>{let U;if(p!==void 0){if(U=()=>{let E=new nu("Aborted","AbortError"),x=[];u||x.push(()=>r._state==="writable"?Br(r,E):w(void 0)),c||x.push(()=>e._state==="readable"?ce(e,E):w(void 0)),Q(()=>Promise.all(x.map(F=>F())),!0,E)},p.aborted){U();return}p.addEventListener("abort",U)}function de(){return g((E,x)=>{function F(Z){Z?E():y(gt(),F,x)}F(!1)})}function gt(){return k?w(!0):y(R._readyPromise,()=>g((E,x)=>{It(_,{_chunkSteps:F=>{B=y(Rs(R,F),void 0,n),E(!1)},_closeSteps:()=>E(!0),_errorSteps:x})}))}if(Re(e,_._closedPromise,E=>{u?ne(!0,E):Q(()=>Br(r,E),!0,E)}),Re(r,R._closedPromise,E=>{c?ne(!0,E):Q(()=>ce(e,E),!0,E)}),Y(e,_._closedPromise,()=>{i?ne():Q(()=>$l(R))}),pe(r)||r._state==="closed"){let E=new TypeError("the destination writable stream closed before all data could be piped to it");c?ne(!0,E):Q(()=>ce(e,E),!0,E)}N(de());function qe(){let E=B;return y(B,()=>E!==B?qe():void 0)}function Re(E,x,F){E._state==="errored"?F(E._storedError):A(x,F)}function Y(E,x,F){E._state==="closed"?F():P(x,F)}function Q(E,x,F){if(k)return;k=!0,r._state==="writable"&&!pe(r)?P(qe(),Z):Z();function Z(){T(E(),()=>Te(x,F),St=>Te(!0,St))}}function ne(E,x){k||(k=!0,r._state==="writable"&&!pe(r)?P(qe(),()=>Te(E,x)):Te(E,x))}function Te(E,x){ws(R),ge(_),p!==void 0&&p.removeEventListener("abort",U),E?L(x):O(void 0)}})}class bt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!qr(this))throw Ur("desiredSize");return Yn(this)}close(){if(!qr(this))throw Ur("close");if(!yt(this))throw new TypeError("The stream is not in a state that permits close");Vt(this)}enqueue(r=void 0){if(!qr(this))throw Ur("enqueue");if(!yt(this))throw new TypeError("The stream is not in a state that permits enqueue");return Mr(this,r)}error(r=void 0){if(!qr(this))throw Ur("error");De(this,r)}[Tn](r){Le(this);let i=this._cancelAlgorithm(r);return Nr(this),i}[En](r){let i=this._controlledReadableStream;if(this._queue.length>0){let u=kn(this);this._closeRequested&&this._queue.length===0?(Nr(this),Yt(i)):Gt(this),r._chunkSteps(u)}else Ho(i,r),Gt(this)}}Object.defineProperties(bt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(bt.prototype,t.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});function qr(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")?!1:e instanceof bt}function Gt(e){if(!Ls(e))return;if(e._pulling){e._pullAgain=!0;return}e._pulling=!0;let i=e._pullAlgorithm();T(i,()=>{e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Gt(e))},u=>{De(e,u)})}function Ls(e){let r=e._controlledReadableStream;return!yt(e)||!e._started?!1:!!(Fe(r)&&gr(r)>0||Yn(e)>0)}function Nr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Vt(e){if(!yt(e))return;let r=e._controlledReadableStream;e._closeRequested=!0,e._queue.length===0&&(Nr(e),Yt(r))}function Mr(e,r){if(!yt(e))return;let i=e._controlledReadableStream;if(Fe(i)&&gr(i)>0)An(i,r,!1);else{let u;try{u=e._strategySizeAlgorithm(r)}catch(c){throw De(e,c),c}try{xn(e,r,u)}catch(c){throw De(e,c),c}}Gt(e)}function De(e,r){let i=e._controlledReadableStream;i._state==="readable"&&(Le(e),Nr(e),Fs(i,r))}function Yn(e){let r=e._controlledReadableStream._state;return r==="errored"?null:r==="closed"?0:e._strategyHWM-e._queueTotalSize}function ou(e){return!Ls(e)}function yt(e){let r=e._controlledReadableStream._state;return!e._closeRequested&&r==="readable"}function Ds(e,r,i,u,c,p,_){r._controlledReadableStream=e,r._queue=void 0,r._queueTotalSize=void 0,Le(r),r._started=!1,r._closeRequested=!1,r._pullAgain=!1,r._pulling=!1,r._strategySizeAlgorithm=_,r._strategyHWM=p,r._pullAlgorithm=u,r._cancelAlgorithm=c,e._readableStreamController=r;let R=i();T(w(R),()=>{r._started=!0,Gt(r)},k=>{De(r,k)})}function su(e,r,i,u){let c=Object.create(bt.prototype),p=()=>{},_=()=>w(void 0),R=()=>w(void 0);r.start!==void 0&&(p=()=>r.start(c)),r.pull!==void 0&&(_=()=>r.pull(c)),r.cancel!==void 0&&(R=k=>r.cancel(k)),Ds(e,c,p,_,R,i,u)}function Ur(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function iu(e,r){return Xe(e._readableStreamController)?lu(e):au(e)}function au(e,r){let i=dt(e),u=!1,c=!1,p=!1,_=!1,R,k,B,O,L,U=g(Y=>{L=Y});function de(){return u?(c=!0,w(void 0)):(u=!0,It(i,{_chunkSteps:Q=>{W(()=>{c=!1;let ne=Q,Te=Q;p||Mr(B._readableStreamController,ne),_||Mr(O._readableStreamController,Te),u=!1,c&&de()})},_closeSteps:()=>{u=!1,p||Vt(B._readableStreamController),_||Vt(O._readableStreamController),(!p||!_)&&L(void 0)},_errorSteps:()=>{u=!1}}),w(void 0))}function gt(Y){if(p=!0,R=Y,_){let Q=Ft([R,k]),ne=ce(e,Q);L(ne)}return U}function qe(Y){if(_=!0,k=Y,p){let Q=Ft([R,k]),ne=ce(e,Q);L(ne)}return U}function Re(){}return B=Qn(Re,de,gt),O=Qn(Re,de,qe),A(i._closedPromise,Y=>{De(B._readableStreamController,Y),De(O._readableStreamController,Y),(!p||!_)&&L(void 0)}),[B,O]}function lu(e){let r=dt(e),i=!1,u=!1,c=!1,p=!1,_=!1,R,k,B,O,L,U=g(E=>{L=E});function de(E){A(E._closedPromise,x=>{E===r&&(fe(B._readableStreamController,x),fe(O._readableStreamController,x),(!p||!_)&&L(void 0))})}function gt(){Ke(r)&&(ge(r),r=dt(e),de(r)),It(r,{_chunkSteps:x=>{W(()=>{u=!1,c=!1;let F=x,Z=x;if(!p&&!_)try{Z=ts(x)}catch(St){fe(B._readableStreamController,St),fe(O._readableStreamController,St),L(ce(e,St));return}p||Cr(B._readableStreamController,F),_||Cr(O._readableStreamController,Z),i=!1,u?Re():c&&Y()})},_closeSteps:()=>{i=!1,p||Nt(B._readableStreamController),_||Nt(O._readableStreamController),B._readableStreamController._pendingPullIntos.length>0&&Pr(B._readableStreamController,0),O._readableStreamController._pendingPullIntos.length>0&&Pr(O._readableStreamController,0),(!p||!_)&&L(void 0)},_errorSteps:()=>{i=!1}})}function qe(E,x){Oe(r)&&(ge(r),r=cs(e),de(r));let F=x?O:B,Z=x?B:O;ms(r,E,{_chunkSteps:wt=>{W(()=>{u=!1,c=!1;let Rt=x?_:p;if(x?p:_)Rt||vr(F._readableStreamController,wt);else{let Xs;try{Xs=ts(wt)}catch(Jn){fe(F._readableStreamController,Jn),fe(Z._readableStreamController,Jn),L(ce(e,Jn));return}Rt||vr(F._readableStreamController,wt),Cr(Z._readableStreamController,Xs)}i=!1,u?Re():c&&Y()})},_closeSteps:wt=>{i=!1;let Rt=x?_:p,Xr=x?p:_;Rt||Nt(F._readableStreamController),Xr||Nt(Z._readableStreamController),wt!==void 0&&(Rt||vr(F._readableStreamController,wt),!Xr&&Z._readableStreamController._pendingPullIntos.length>0&&Pr(Z._readableStreamController,0)),(!Rt||!Xr)&&L(void 0)},_errorSteps:()=>{i=!1}})}function Re(){if(i)return u=!0,w(void 0);i=!0;let E=Dn(B._readableStreamController);return E===null?gt():qe(E._view,!1),w(void 0)}function Y(){if(i)return c=!0,w(void 0);i=!0;let E=Dn(O._readableStreamController);return E===null?gt():qe(E._view,!0),w(void 0)}function Q(E){if(p=!0,R=E,_){let x=Ft([R,k]),F=ce(e,x);L(F)}return U}function ne(E){if(_=!0,k=E,p){let x=Ft([R,k]),F=ce(e,x);L(F)}return U}function Te(){}return B=Is(Te,Re,Q),O=Is(Te,Y,ne),de(r),[B,O]}function uu(e,r){Se(e,r);let i=e,u=i==null?void 0:i.autoAllocateChunkSize,c=i==null?void 0:i.cancel,p=i==null?void 0:i.pull,_=i==null?void 0:i.start,R=i==null?void 0:i.type;return{autoAllocateChunkSize:u===void 0?void 0:jo(u,`${r} has member 'autoAllocateChunkSize' that`),cancel:c===void 0?void 0:fu(c,i,`${r} has member 'cancel' that`),pull:p===void 0?void 0:cu(p,i,`${r} has member 'pull' that`),start:_===void 0?void 0:du(_,i,`${r} has member 'start' that`),type:R===void 0?void 0:hu(R,`${r} has member 'type' that`)}}function fu(e,r,i){return ue(e,i),u=>I(e,r,[u])}function cu(e,r,i){return ue(e,i),u=>I(e,r,[u])}function du(e,r,i){return ue(e,i),u=>M(e,r,[u])}function hu(e,r){if(e=`${e}`,e!=="bytes")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function mu(e,r){Se(e,r);let i=e==null?void 0:e.mode;return{mode:i===void 0?void 0:pu(i,`${r} has member 'mode' that`)}}function pu(e,r){if(e=`${e}`,e!=="byob")throw new TypeError(`${r} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function _u(e,r){Se(e,r);let i=e==null?void 0:e.preventCancel;return{preventCancel:Boolean(i)}}function Ws(e,r){Se(e,r);let i=e==null?void 0:e.preventAbort,u=e==null?void 0:e.preventCancel,c=e==null?void 0:e.preventClose,p=e==null?void 0:e.signal;return p!==void 0&&bu(p,`${r} has member 'signal' that`),{preventAbort:Boolean(i),preventCancel:Boolean(u),preventClose:Boolean(c),signal:p}}function bu(e,r){if(!kl(e))throw new TypeError(`${r} is not an AbortSignal.`)}function yu(e,r){Se(e,r);let i=e==null?void 0:e.readable;Cn(i,"readable","ReadableWritablePair"),vn(i,`${r} has member 'readable' that`);let u=e==null?void 0:e.writable;return Cn(u,"writable","ReadableWritablePair"),ps(u,`${r} has member 'writable' that`),{readable:i,writable:u}}class We{constructor(r={},i={}){r===void 0?r=null:$o(r,"First parameter");let u=xr(i,"Second parameter"),c=uu(r,"First parameter");if(Xn(this),c.type==="bytes"){if(u.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");let p=$t(u,0);Sl(this,c,p)}else{let p=kr(u),_=$t(u,1);su(this,c,_,p)}}get locked(){if(!Ie(this))throw tt("locked");return Fe(this)}cancel(r=void 0){return Ie(this)?Fe(this)?S(new TypeError("Cannot cancel a stream that already has a reader")):ce(this,r):S(tt("cancel"))}getReader(r=void 0){if(!Ie(this))throw tt("getReader");return mu(r,"First parameter").mode===void 0?dt(this):cs(this)}pipeThrough(r,i={}){if(!Ie(this))throw tt("pipeThrough");we(r,1,"pipeThrough");let u=yu(r,"First parameter"),c=Ws(i,"Second parameter");if(Fe(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(pt(u.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");let p=Os(this,u.writable,c.preventClose,c.preventAbort,c.preventCancel,c.signal);return N(p),u.readable}pipeTo(r,i={}){if(!Ie(this))return S(tt("pipeTo"));if(r===void 0)return S("Parameter 1 is required in 'pipeTo'.");if(!mt(r))return S(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let u;try{u=Ws(i,"Second parameter")}catch(c){return S(c)}return Fe(this)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):pt(r)?S(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Os(this,r,u.preventClose,u.preventAbort,u.preventCancel,u.signal)}tee(){if(!Ie(this))throw tt("tee");let r=iu(this);return Ft(r)}values(r=void 0){if(!Ie(this))throw tt("values");let i=_u(r,"First parameter");return hl(this,i.preventCancel)}}Object.defineProperties(We.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(We.prototype,t.toStringTag,{value:"ReadableStream",configurable:!0}),typeof t.asyncIterator=="symbol"&&Object.defineProperty(We.prototype,t.asyncIterator,{value:We.prototype.values,writable:!0,configurable:!0});function Qn(e,r,i,u=1,c=()=>1){let p=Object.create(We.prototype);Xn(p);let _=Object.create(bt.prototype);return Ds(p,_,e,r,i,u,c),p}function Is(e,r,i){let u=Object.create(We.prototype);Xn(u);let c=Object.create(ht.prototype);return fs(u,c,e,r,i,0,void 0),u}function Xn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Ie(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")?!1:e instanceof We}function Fe(e){return e._reader!==void 0}function ce(e,r){if(e._disturbed=!0,e._state==="closed")return w(void 0);if(e._state==="errored")return S(e._storedError);Yt(e);let i=e._reader;i!==void 0&&Ke(i)&&(i._readIntoRequests.forEach(c=>{c._closeSteps(void 0)}),i._readIntoRequests=new V);let u=e._readableStreamController[Tn](r);return D(u,n)}function Yt(e){e._state="closed";let r=e._reader;r!==void 0&&(qo(r),Oe(r)&&(r._readRequests.forEach(i=>{i._closeSteps()}),r._readRequests=new V))}function Fs(e,r){e._state="errored",e._storedError=r;let i=e._reader;i!==void 0&&(Rn(i,r),Oe(i)?(i._readRequests.forEach(u=>{u._errorSteps(r)}),i._readRequests=new V):(i._readIntoRequests.forEach(u=>{u._errorSteps(r)}),i._readIntoRequests=new V))}function tt(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function qs(e,r){Se(e,r);let i=e==null?void 0:e.highWaterMark;return Cn(i,"highWaterMark","QueuingStrategyInit"),{highWaterMark:Pn(i)}}let Ns=e=>e.byteLength;Object.defineProperty(Ns,"name",{value:"size",configurable:!0});class $r{constructor(r){we(r,1,"ByteLengthQueuingStrategy"),r=qs(r,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!Us(this))throw Ms("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!Us(this))throw Ms("size");return Ns}}Object.defineProperties($r.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty($r.prototype,t.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});function Ms(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function Us(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")?!1:e instanceof $r}let $s=()=>1;Object.defineProperty($s,"name",{value:"size",configurable:!0});class zr{constructor(r){we(r,1,"CountQueuingStrategy"),r=qs(r,"First parameter"),this._countQueuingStrategyHighWaterMark=r.highWaterMark}get highWaterMark(){if(!js(this))throw zs("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!js(this))throw zs("size");return $s}}Object.defineProperties(zr.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(zr.prototype,t.toStringTag,{value:"CountQueuingStrategy",configurable:!0});function zs(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function js(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")?!1:e instanceof zr}function gu(e,r){Se(e,r);let i=e==null?void 0:e.flush,u=e==null?void 0:e.readableType,c=e==null?void 0:e.start,p=e==null?void 0:e.transform,_=e==null?void 0:e.writableType;return{flush:i===void 0?void 0:Su(i,e,`${r} has member 'flush' that`),readableType:u,start:c===void 0?void 0:wu(c,e,`${r} has member 'start' that`),transform:p===void 0?void 0:Ru(p,e,`${r} has member 'transform' that`),writableType:_}}function Su(e,r,i){return ue(e,i),u=>I(e,r,[u])}function wu(e,r,i){return ue(e,i),u=>M(e,r,[u])}function Ru(e,r,i){return ue(e,i),(u,c)=>I(e,r,[u,c])}class jr{constructor(r={},i={},u={}){r===void 0&&(r=null);let c=xr(i,"Second parameter"),p=xr(u,"Third parameter"),_=gu(r,"First parameter");if(_.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(_.writableType!==void 0)throw new RangeError("Invalid writableType specified");let R=$t(p,0),k=kr(p),B=$t(c,1),O=kr(c),L,U=g(de=>{L=de});Tu(this,U,B,O,R,k),Cu(this,_),_.start!==void 0?L(_.start(this._transformStreamController)):L(void 0)}get readable(){if(!Hs(this))throw Qs("readable");return this._readable}get writable(){if(!Hs(this))throw Qs("writable");return this._writable}}Object.defineProperties(jr.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(jr.prototype,t.toStringTag,{value:"TransformStream",configurable:!0});function Tu(e,r,i,u,c,p){function _(){return r}function R(U){return Au(e,U)}function k(U){return ku(e,U)}function B(){return xu(e)}e._writable=Ol(_,R,B,k,i,u);function O(){return Bu(e)}function L(U){return Gr(e,U),w(void 0)}e._readable=Qn(_,O,L,c,p),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Vr(e,!0),e._transformStreamController=void 0}function Hs(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")?!1:e instanceof jr}function Hr(e,r){De(e._readable._readableStreamController,r),Gr(e,r)}function Gr(e,r){Gs(e._transformStreamController),$n(e._writable._writableStreamController,r),e._backpressure&&Vr(e,!1)}function Vr(e,r){e._backpressureChangePromise!==void 0&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=g(i=>{e._backpressureChangePromise_resolve=i}),e._backpressure=r}class Qt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Yr(this))throw Qr("desiredSize");let r=this._controlledTransformStream._readable._readableStreamController;return Yn(r)}enqueue(r=void 0){if(!Yr(this))throw Qr("enqueue");Vs(this,r)}error(r=void 0){if(!Yr(this))throw Qr("error");Pu(this,r)}terminate(){if(!Yr(this))throw Qr("terminate");vu(this)}}Object.defineProperties(Qt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),typeof t.toStringTag=="symbol"&&Object.defineProperty(Qt.prototype,t.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});function Yr(e){return!l(e)||!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")?!1:e instanceof Qt}function Eu(e,r,i,u){r._controlledTransformStream=e,e._transformStreamController=r,r._transformAlgorithm=i,r._flushAlgorithm=u}function Cu(e,r){let i=Object.create(Qt.prototype),u=p=>{try{return Vs(i,p),w(void 0)}catch(_){return S(_)}},c=()=>w(void 0);r.transform!==void 0&&(u=p=>r.transform(p,i)),r.flush!==void 0&&(c=()=>r.flush(i)),Eu(e,i,u,c)}function Gs(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function Vs(e,r){let i=e._controlledTransformStream,u=i._readable._readableStreamController;if(!yt(u))throw new TypeError("Readable side is not in a state that permits enqueue");try{Mr(u,r)}catch(p){throw Gr(i,p),i._readable._storedError}ou(u)!==i._backpressure&&Vr(i,!0)}function Pu(e,r){Hr(e._controlledTransformStream,r)}function Ys(e,r){let i=e._transformAlgorithm(r);return D(i,void 0,u=>{throw Hr(e._controlledTransformStream,u),u})}function vu(e){let r=e._controlledTransformStream,i=r._readable._readableStreamController;Vt(i);let u=new TypeError("TransformStream terminated");Gr(r,u)}function Au(e,r){let i=e._transformStreamController;if(e._backpressure){let u=e._backpressureChangePromise;return D(u,()=>{let c=e._writable;if(c._state==="erroring")throw c._storedError;return Ys(i,r)})}return Ys(i,r)}function ku(e,r){return Hr(e,r),w(void 0)}function xu(e){let r=e._readable,i=e._transformStreamController,u=i._flushAlgorithm();return Gs(i),D(u,()=>{if(r._state==="errored")throw r._storedError;Vt(r._readableStreamController)},c=>{throw Hr(e,c),r._storedError})}function Bu(e){return Vr(e,!1),e._backpressureChangePromise}function Qr(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Qs(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}o.ByteLengthQueuingStrategy=$r,o.CountQueuingStrategy=zr,o.ReadableByteStreamController=ht,o.ReadableStream=We,o.ReadableStreamBYOBReader=Ut,o.ReadableStreamBYOBRequest=qt,o.ReadableStreamDefaultController=bt,o.ReadableStreamDefaultReader=Wt,o.TransformStream=jr,o.TransformStreamDefaultController=Qt,o.WritableStream=zt,o.WritableStreamDefaultController=_t,o.WritableStreamDefaultWriter=jt,Object.defineProperty(o,"__esModule",{value:!0})})});var ii=H(()=>{if(!globalThis.ReadableStream)try{let o=require("node:process"),{emitWarning:t}=o;try{o.emitWarning=()=>{},Object.assign(globalThis,require("node:stream/web")),o.emitWarning=t}catch(n){throw o.emitWarning=t,n}}catch{Object.assign(globalThis,si())}try{let{Blob:o}=require("buffer");o&&!o.prototype.stream&&(o.prototype.stream=function(n){let s=0,a=this;return new ReadableStream({type:"bytes",async pull(l){let m=await a.slice(s,Math.min(a.size,s+65536)).arrayBuffer();s+=m.byteLength,l.enqueue(new Uint8Array(m)),s===a.size&&l.close()}})})}catch{}});async function*Kn(o,t=!0){for(let n of o)if("stream"in n)yield*n.stream();else if(ArrayBuffer.isView(n))if(t){let s=n.byteOffset,a=n.byteOffset+n.byteLength;for(;s!==a;){let l=Math.min(a-s,ai),f=n.buffer.slice(s,s+l);s+=f.byteLength,yield new Uint8Array(f)}}else yield n;else{let s=0;for(;s!==n.size;){let l=await n.slice(s,Math.min(n.size,s+ai)).arrayBuffer();s+=l.byteLength,yield new Uint8Array(l)}}}var Dc,ai,li,Uu,nt,Kt=Jt(()=>{Dc=rt(ii(),1);ai=65536;li=class Zn{#e=[];#t="";#r=0;constructor(t=[],n={}){if(typeof t!="object"||t===null)throw new TypeError("Failed to construct 'Blob': The provided value cannot be converted to a sequence.");if(typeof t[Symbol.iterator]!="function")throw new TypeError("Failed to construct 'Blob': The object must have a callable @@iterator property.");if(typeof n!="object"&&typeof n!="function")throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");n===null&&(n={});let s=new TextEncoder;for(let l of t){let f;ArrayBuffer.isView(l)?f=new Uint8Array(l.buffer.slice(l.byteOffset,l.byteOffset+l.byteLength)):l instanceof ArrayBuffer?f=new Uint8Array(l.slice(0)):l instanceof Zn?f=l:f=s.encode(l),this.#r+=ArrayBuffer.isView(f)?f.byteLength:f.size,this.#e.push(f)}let a=n.type===void 0?"":String(n.type);this.#t=/^[\x20-\x7E]*$/.test(a)?a:""}get size(){return this.#r}get type(){return this.#t}async text(){let t=new TextDecoder,n="";for await(let s of Kn(this.#e,!1))n+=t.decode(s,{stream:!0});return n+=t.decode(),n}async arrayBuffer(){let t=new Uint8Array(this.size),n=0;for await(let s of Kn(this.#e,!1))t.set(s,n),n+=s.length;return t.buffer}stream(){let t=Kn(this.#e,!0);return new globalThis.ReadableStream({type:"bytes",async pull(n){let s=await t.next();s.done?n.close():n.enqueue(s.value)},async cancel(){await t.return()}})}slice(t=0,n=this.size,s=""){let{size:a}=this,l=t<0?Math.max(a+t,0):Math.min(t,a),f=n<0?Math.max(a+n,0):Math.min(n,a),m=Math.max(f-l,0),d=this.#e,h=[],b=0;for(let w of d){if(b>=m)break;let S=ArrayBuffer.isView(w)?w.byteLength:w.size;if(l&&S<=l)l-=S,f-=S;else{let y;ArrayBuffer.isView(w)?(y=w.subarray(l,Math.min(S,f)),b+=y.byteLength):(y=w.slice(l,Math.min(S,f)),b+=y.size),f-=S,h.push(y),l=0}}let g=new Zn([],{type:String(s).toLowerCase()});return g.#r=m,g.#e=h,g}get[Symbol.toStringTag](){return"Blob"}static[Symbol.hasInstance](t){return t&&typeof t=="object"&&typeof t.constructor=="function"&&(typeof t.stream=="function"||typeof t.arrayBuffer=="function")&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}};Object.defineProperties(li.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}});Uu=li,nt=Uu});var $u,zu,Zt,eo=Jt(()=>{Kt();$u=class extends nt{#e=0;#t="";constructor(t,n,s={}){if(arguments.length<2)throw new TypeError(`Failed to construct 'File': 2 arguments required, but only ${arguments.length} present.`);super(t,s);s===null&&(s={});let a=s.lastModified===void 0?Date.now():Number(s.lastModified);Number.isNaN(a)||(this.#e=a),this.#t=String(n)}get name(){return this.#t}get lastModified(){return this.#e}get[Symbol.toStringTag](){return"File"}},zu=$u,Zt=zu});function ci(o,t=nt){var n=`${ui()}${ui()}`.replace(/\./g,"").slice(-28).padStart(32,"-"),s=[],a=`--${n}\r
Content-Disposition: form-data; name="`;return o.forEach((l,f)=>typeof l=="string"?s.push(a+to(f)+`"\r
\r
${l.replace(/\r(?!\n)|(?<!\r)\n/g,`\r
`)}\r
`):s.push(a+to(f)+`"; filename="${to(l.name,1)}"\r
Content-Type: ${l.type||"application/octet-stream"}\r
\r
`,l,`\r
`)),s.push(`--${n}--`),new t(s,{type:"multipart/form-data; boundary="+n})}var er,ju,Hu,ui,Gu,fi,to,ot,Tt,ro=Jt(()=>{Kt();eo();({toStringTag:er,iterator:ju,hasInstance:Hu}=Symbol),ui=Math.random,Gu="append,set,get,getAll,delete,keys,values,entries,forEach,constructor".split(","),fi=(o,t,n)=>(o+="",/^(Blob|File)$/.test(t&&t[er])?[(n=n!==void 0?n+"":t[er]=="File"?t.name:"blob",o),t.name!==n||t[er]=="blob"?new Zt([t],n,t):t]:[o,t+""]),to=(o,t)=>(t?o:o.replace(/\r?\n|\r/g,`\r
`)).replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22"),ot=(o,t,n)=>{if(t.length<n)throw new TypeError(`Failed to execute '${o}' on 'FormData': ${n} arguments required, but only ${t.length} present.`)},Tt=class{#e=[];constructor(...t){if(t.length)throw new TypeError("Failed to construct 'FormData': parameter 1 is not of type 'HTMLFormElement'.")}get[er](){return"FormData"}[ju](){return this.entries()}static[Hu](t){return t&&typeof t=="object"&&t[er]==="FormData"&&!Gu.some(n=>typeof t[n]!="function")}append(...t){ot("append",arguments,2),this.#e.push(fi(...t))}delete(t){ot("delete",arguments,1),t+="",this.#e=this.#e.filter(([n])=>n!==t)}get(t){ot("get",arguments,1),t+="";for(var n=this.#e,s=n.length,a=0;a<s;a++)if(n[a][0]===t)return n[a][1];return null}getAll(t,n){return ot("getAll",arguments,1),n=[],t+="",this.#e.forEach(s=>s[0]===t&&n.push(s[1])),n}has(t){return ot("has",arguments,1),t+="",this.#e.some(n=>n[0]===t)}forEach(t,n){ot("forEach",arguments,1);for(var[s,a]of this)t.call(n,a,s,this)}set(...t){ot("set",arguments,2);var n=[],s=!0;t=fi(...t),this.#e.forEach(a=>{a[0]===t[0]?s&&(s=!n.push(t)):n.push(a)}),s&&n.push(t),this.#e=n}*entries(){yield*this.#e}*keys(){for(var[t]of this)yield t}*values(){for(var[,t]of this)yield t}}});var rr,hi,Vu,Yu,oo,mi=Jt(()=>{rr=require("node:fs"),hi=require("node:worker_threads");eo();Kt();({stat:Vu}=rr.promises),Yu=globalThis.DOMException||(()=>{let o=new hi.MessageChannel().port1,t=new ArrayBuffer(0);try{o.postMessage(t,[t,t])}catch(n){return n.constructor}})(),oo=class{#e;#t;constructor(t){this.#e=t.path,this.#t=t.start,this.size=t.size,this.lastModified=t.lastModified}slice(t,n){return new oo({path:this.#e,lastModified:this.lastModified,size:n-t,start:t})}async*stream(){let{mtimeMs:t}=await Vu(this.#e);if(t>this.lastModified)throw new Yu("The requested file could not be read, typically due to permission problems that have occurred after a reference to a file was acquired.","NotReadableError");yield*(0,rr.createReadStream)(this.#e,{start:this.#t,end:this.#t+this.size-1})}get[Symbol.toStringTag](){return"Blob"}}});var bi={};ti(bi,{toFormData:()=>tf});function ef(o){let t=o.match(/\bfilename=("(.*?)"|([^()<>@,;:\\"/[\]?={}\s\t]+))($|;\s)/i);if(!t)return;let n=t[2]||t[3]||"",s=n.slice(n.lastIndexOf("\\")+1);return s=s.replace(/%22/g,'"'),s=s.replace(/&#(\d{4});/g,(a,l)=>String.fromCharCode(l)),s}async function tf(o,t){if(!/multipart/i.test(t))throw new TypeError("Failed to fetch");let n=t.match(/boundary=(?:"([^"]+)"|([^;]+))/i);if(!n)throw new TypeError("no or bad content-type header, no multipart boundary");let s=new _i(n[1]||n[2]),a,l,f,m,d,h,b=[],g=new Tt,w=A=>{f+=P.decode(A,{stream:!0})},S=A=>{b.push(A)},y=()=>{let A=new Zt(b,h,{type:d});g.append(m,A)},T=()=>{g.append(m,f)},P=new TextDecoder("utf-8");P.decode(),s.onPartBegin=function(){s.onPartData=w,s.onPartEnd=T,a="",l="",f="",m="",d="",h=null,b.length=0},s.onHeaderField=function(A){a+=P.decode(A,{stream:!0})},s.onHeaderValue=function(A){l+=P.decode(A,{stream:!0})},s.onHeaderEnd=function(){if(l+=P.decode(),a=a.toLowerCase(),a==="content-disposition"){let A=l.match(/\bname=("([^"]*)"|([^()<>@,;:\\"/[\]?={}\s\t]+))/i);A&&(m=A[2]||A[3]||""),h=ef(l),h&&(s.onPartData=S,s.onPartEnd=y)}else a==="content-type"&&(d=l);l="",a=""};for await(let A of o)s.write(A);return s.end(),g}var _e,q,pi,Me,Zr,en,Qu,nr,Xu,Ju,Ku,Zu,st,_i,yi=Jt(()=>{mi();ro();_e=0,q={START_BOUNDARY:_e++,HEADER_FIELD_START:_e++,HEADER_FIELD:_e++,HEADER_VALUE_START:_e++,HEADER_VALUE:_e++,HEADER_VALUE_ALMOST_DONE:_e++,HEADERS_ALMOST_DONE:_e++,PART_DATA_START:_e++,PART_DATA:_e++,END:_e++},pi=1,Me={PART_BOUNDARY:pi,LAST_BOUNDARY:pi*=2},Zr=10,en=13,Qu=32,nr=45,Xu=58,Ju=97,Ku=122,Zu=o=>o|32,st=()=>{},_i=class{constructor(t){this.index=0,this.flags=0,this.onHeaderEnd=st,this.onHeaderField=st,this.onHeadersEnd=st,this.onHeaderValue=st,this.onPartBegin=st,this.onPartData=st,this.onPartEnd=st,this.boundaryChars={},t=`\r
--`+t;let n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s),this.boundaryChars[n[s]]=!0;this.boundary=n,this.lookbehind=new Uint8Array(this.boundary.length+8),this.state=q.START_BOUNDARY}write(t){let n=0,s=t.length,a=this.index,{lookbehind:l,boundary:f,boundaryChars:m,index:d,state:h,flags:b}=this,g=this.boundary.length,w=g-1,S=t.length,y,T,P=W=>{this[W+"Mark"]=n},A=W=>{delete this[W+"Mark"]},D=(W,M,I,le)=>{(M===void 0||M!==I)&&this[W](le&&le.subarray(M,I))},N=(W,M)=>{let I=W+"Mark";I in this&&(M?(D(W,this[I],n,t),delete this[I]):(D(W,this[I],t.length,t),this[I]=0))};for(n=0;n<s;n++)switch(y=t[n],h){case q.START_BOUNDARY:if(d===f.length-2){if(y===nr)b|=Me.LAST_BOUNDARY;else if(y!==en)return;d++;break}else if(d-1===f.length-2){if(b&Me.LAST_BOUNDARY&&y===nr)h=q.END,b=0;else if(!(b&Me.LAST_BOUNDARY)&&y===Zr)d=0,D("onPartBegin"),h=q.HEADER_FIELD_START;else return;break}y!==f[d+2]&&(d=-2),y===f[d+2]&&d++;break;case q.HEADER_FIELD_START:h=q.HEADER_FIELD,P("onHeaderField"),d=0;case q.HEADER_FIELD:if(y===en){A("onHeaderField"),h=q.HEADERS_ALMOST_DONE;break}if(d++,y===nr)break;if(y===Xu){if(d===1)return;N("onHeaderField",!0),h=q.HEADER_VALUE_START;break}if(T=Zu(y),T<Ju||T>Ku)return;break;case q.HEADER_VALUE_START:if(y===Qu)break;P("onHeaderValue"),h=q.HEADER_VALUE;case q.HEADER_VALUE:y===en&&(N("onHeaderValue",!0),D("onHeaderEnd"),h=q.HEADER_VALUE_ALMOST_DONE);break;case q.HEADER_VALUE_ALMOST_DONE:if(y!==Zr)return;h=q.HEADER_FIELD_START;break;case q.HEADERS_ALMOST_DONE:if(y!==Zr)return;D("onHeadersEnd"),h=q.PART_DATA_START;break;case q.PART_DATA_START:h=q.PART_DATA,P("onPartData");case q.PART_DATA:if(a=d,d===0){for(n+=w;n<S&&!(t[n]in m);)n+=g;n-=w,y=t[n]}if(d<f.length)f[d]===y?(d===0&&N("onPartData",!0),d++):d=0;else if(d===f.length)d++,y===en?b|=Me.PART_BOUNDARY:y===nr?b|=Me.LAST_BOUNDARY:d=0;else if(d-1===f.length)if(b&Me.PART_BOUNDARY){if(d=0,y===Zr){b&=~Me.PART_BOUNDARY,D("onPartEnd"),D("onPartBegin"),h=q.HEADER_FIELD_START;break}}else b&Me.LAST_BOUNDARY&&y===nr?(D("onPartEnd"),h=q.END,b=0):d=0;if(d>0)l[d-1]=y;else if(a>0){let W=new Uint8Array(l.buffer,l.byteOffset,l.byteLength);D("onPartData",0,a,W),a=0,P("onPartData"),n--}break;case q.END:break;default:throw new Error(`Unexpected state entered: ${h}`)}N("onHeaderField"),N("onHeaderValue"),N("onPartData"),this.index=d,this.state=h,this.flags=b}end(){if(this.state===q.HEADER_FIELD_START&&this.index===0||this.state===q.PART_DATA&&this.index===this.boundary.length)this.onPartEnd();else if(this.state!==q.END)throw new Error("MultipartParser.end(): stream ended unexpectedly")}}});var je=H((qd,Mi)=>{"use strict";Mi.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var lr=H((Nd,mo)=>{"use strict";var{EMPTY_BUFFER:hf}=je();function Ui(o,t){if(o.length===0)return hf;if(o.length===1)return o[0];let n=Buffer.allocUnsafe(t),s=0;for(let a=0;a<o.length;a++){let l=o[a];n.set(l,s),s+=l.length}return s<t?n.slice(0,s):n}function $i(o,t,n,s,a){for(let l=0;l<a;l++)n[s+l]=o[l]^t[l&3]}function zi(o,t){for(let n=0;n<o.length;n++)o[n]^=t[n&3]}function ji(o){return o.byteLength===o.buffer.byteLength?o.buffer:o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)}function un(o){if(un.readOnly=!0,Buffer.isBuffer(o))return o;let t;return o instanceof ArrayBuffer?t=Buffer.from(o):ArrayBuffer.isView(o)?t=Buffer.from(o.buffer,o.byteOffset,o.byteLength):(t=Buffer.from(o),un.readOnly=!1),t}try{let o=require("bufferutil");mo.exports={concat:Ui,mask(t,n,s,a,l){l<48?$i(t,n,s,a,l):o.mask(t,n,s,a,l)},toArrayBuffer:ji,toBuffer:un,unmask(t,n){t.length<32?zi(t,n):o.unmask(t,n)}}}catch{mo.exports={concat:Ui,mask:$i,toArrayBuffer:ji,toBuffer:un,unmask:zi}}});var Yi=H((Md,Vi)=>{"use strict";var Hi=Symbol("kDone"),po=Symbol("kRun"),Gi=class{constructor(t){this[Hi]=()=>{this.pending--,this[po]()},this.concurrency=t||1/0,this.jobs=[],this.pending=0}add(t){this.jobs.push(t),this[po]()}[po](){if(this.pending!==this.concurrency&&this.jobs.length){let t=this.jobs.shift();this.pending++,t(this[Hi])}}};Vi.exports=Gi});var cr=H((Ud,Zi)=>{"use strict";var ur=require("zlib"),Qi=lr(),mf=Yi(),{kStatusCode:Xi}=je(),pf=Buffer.from([0,0,255,255]),dn=Symbol("permessage-deflate"),Pe=Symbol("total-length"),fr=Symbol("callback"),He=Symbol("buffers"),cn=Symbol("error"),fn,Ji=class{constructor(t,n,s){if(this._maxPayload=s|0,this._options=t||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!n,this._deflate=null,this._inflate=null,this.params=null,!fn){let a=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;fn=new mf(a)}}static get extensionName(){return"permessage-deflate"}offer(){let t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(t.client_max_window_bits=!0),t}accept(t){return t=this.normalizeParams(t),this.params=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let t=this._deflate[fr];this._deflate.close(),this._deflate=null,t&&t(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(t){let n=this._options,s=t.find(a=>!(n.serverNoContextTakeover===!1&&a.server_no_context_takeover||a.server_max_window_bits&&(n.serverMaxWindowBits===!1||typeof n.serverMaxWindowBits=="number"&&n.serverMaxWindowBits>a.server_max_window_bits)||typeof n.clientMaxWindowBits=="number"&&!a.client_max_window_bits));if(!s)throw new Error("None of the extension offers can be accepted");return n.serverNoContextTakeover&&(s.server_no_context_takeover=!0),n.clientNoContextTakeover&&(s.client_no_context_takeover=!0),typeof n.serverMaxWindowBits=="number"&&(s.server_max_window_bits=n.serverMaxWindowBits),typeof n.clientMaxWindowBits=="number"?s.client_max_window_bits=n.clientMaxWindowBits:(s.client_max_window_bits===!0||n.clientMaxWindowBits===!1)&&delete s.client_max_window_bits,s}acceptAsClient(t){let n=t[0];if(this._options.clientNoContextTakeover===!1&&n.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!n.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(n.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&n.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return n}normalizeParams(t){return t.forEach(n=>{Object.keys(n).forEach(s=>{let a=n[s];if(a.length>1)throw new Error(`Parameter "${s}" must have only a single value`);if(a=a[0],s==="client_max_window_bits"){if(a!==!0){let l=+a;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${a}`);a=l}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${s}": ${a}`)}else if(s==="server_max_window_bits"){let l=+a;if(!Number.isInteger(l)||l<8||l>15)throw new TypeError(`Invalid value for parameter "${s}": ${a}`);a=l}else if(s==="client_no_context_takeover"||s==="server_no_context_takeover"){if(a!==!0)throw new TypeError(`Invalid value for parameter "${s}": ${a}`)}else throw new Error(`Unknown parameter "${s}"`);n[s]=a})}),t}decompress(t,n,s){fn.add(a=>{this._decompress(t,n,(l,f)=>{a(),s(l,f)})})}compress(t,n,s){fn.add(a=>{this._compress(t,n,(l,f)=>{a(),s(l,f)})})}_decompress(t,n,s){let a=this._isServer?"client":"server";if(!this._inflate){let l=`${a}_max_window_bits`,f=typeof this.params[l]!="number"?ur.Z_DEFAULT_WINDOWBITS:this.params[l];this._inflate=ur.createInflateRaw(Ee(X({},this._options.zlibInflateOptions),{windowBits:f})),this._inflate[dn]=this,this._inflate[Pe]=0,this._inflate[He]=[],this._inflate.on("error",bf),this._inflate.on("data",Ki)}this._inflate[fr]=s,this._inflate.write(t),n&&this._inflate.write(pf),this._inflate.flush(()=>{let l=this._inflate[cn];if(l){this._inflate.close(),this._inflate=null,s(l);return}let f=Qi.concat(this._inflate[He],this._inflate[Pe]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[Pe]=0,this._inflate[He]=[],n&&this.params[`${a}_no_context_takeover`]&&this._inflate.reset()),s(null,f)})}_compress(t,n,s){let a=this._isServer?"server":"client";if(!this._deflate){let l=`${a}_max_window_bits`,f=typeof this.params[l]!="number"?ur.Z_DEFAULT_WINDOWBITS:this.params[l];this._deflate=ur.createDeflateRaw(Ee(X({},this._options.zlibDeflateOptions),{windowBits:f})),this._deflate[Pe]=0,this._deflate[He]=[],this._deflate.on("data",_f)}this._deflate[fr]=s,this._deflate.write(t),this._deflate.flush(ur.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let l=Qi.concat(this._deflate[He],this._deflate[Pe]);n&&(l=l.slice(0,l.length-4)),this._deflate[fr]=null,this._deflate[Pe]=0,this._deflate[He]=[],n&&this.params[`${a}_no_context_takeover`]&&this._deflate.reset(),s(null,l)})}};Zi.exports=Ji;function _f(o){this[He].push(o),this[Pe]+=o.length}function Ki(o){if(this[Pe]+=o.length,this[dn]._maxPayload<1||this[Pe]<=this[dn]._maxPayload){this[He].push(o);return}this[cn]=new RangeError("Max payload size exceeded"),this[cn].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[cn][Xi]=1009,this.removeListener("data",Ki),this.reset()}function bf(o){this[dn]._inflate=null,o[Xi]=1007,this[fr](o)}});var dr=H(($d,_o)=>{"use strict";var ea=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function ta(o){return o>=1e3&&o<=1014&&o!==1004&&o!==1005&&o!==1006||o>=3e3&&o<=4999}function ra(o){let t=o.length,n=0;for(;n<t;)if((o[n]&128)===0)n++;else if((o[n]&224)===192){if(n+1===t||(o[n+1]&192)!==128||(o[n]&254)===192)return!1;n+=2}else if((o[n]&240)===224){if(n+2>=t||(o[n+1]&192)!==128||(o[n+2]&192)!==128||o[n]===224&&(o[n+1]&224)===128||o[n]===237&&(o[n+1]&224)===160)return!1;n+=3}else if((o[n]&248)===240){if(n+3>=t||(o[n+1]&192)!==128||(o[n+2]&192)!==128||(o[n+3]&192)!==128||o[n]===240&&(o[n+1]&240)===128||o[n]===244&&o[n+1]>143||o[n]>244)return!1;n+=4}else return!1;return!0}try{let o=require("utf-8-validate");_o.exports={isValidStatusCode:ta,isValidUTF8(t){return t.length<150?ra(t):o(t)},tokenChars:ea}}catch{_o.exports={isValidStatusCode:ta,isValidUTF8:ra,tokenChars:ea}}});var go=H((zd,fa)=>{"use strict";var{Writable:yf}=require("stream"),na=cr(),{BINARY_TYPES:gf,EMPTY_BUFFER:oa,kStatusCode:Sf,kWebSocket:wf}=je(),{concat:bo,toArrayBuffer:Rf,unmask:Tf}=lr(),{isValidStatusCode:Ef,isValidUTF8:sa}=dr(),hr=0,ia=1,aa=2,la=3,yo=4,Cf=5,ua=class extends yf{constructor(t={}){super();this._binaryType=t.binaryType||gf[0],this._extensions=t.extensions||{},this._isServer=!!t.isServer,this._maxPayload=t.maxPayload|0,this._skipUTF8Validation=!!t.skipUTF8Validation,this[wf]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=hr,this._loop=!1}_write(t,n,s){if(this._opcode===8&&this._state==hr)return s();this._bufferedBytes+=t.length,this._buffers.push(t),this.startLoop(s)}consume(t){if(this._bufferedBytes-=t,t===this._buffers[0].length)return this._buffers.shift();if(t<this._buffers[0].length){let s=this._buffers[0];return this._buffers[0]=s.slice(t),s.slice(0,t)}let n=Buffer.allocUnsafe(t);do{let s=this._buffers[0],a=n.length-t;t>=s.length?n.set(this._buffers.shift(),a):(n.set(new Uint8Array(s.buffer,s.byteOffset,t),a),this._buffers[0]=s.slice(t)),t-=s.length}while(t>0);return n}startLoop(t){let n;this._loop=!0;do switch(this._state){case hr:n=this.getInfo();break;case ia:n=this.getPayloadLength16();break;case aa:n=this.getPayloadLength64();break;case la:this.getMask();break;case yo:n=this.getData(t);break;default:this._loop=!1;return}while(this._loop);t(n)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0)return this._loop=!1,$(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let n=(t[0]&64)===64;if(n&&!this._extensions[na.extensionName])return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(n)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,$(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,$(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(n)return this._loop=!1,$(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125)return this._loop=!1,$(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,$(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,$(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,$(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=ia;else if(this._payloadLength===127)this._state=aa;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),n=t.readUInt32BE(0);return n>Math.pow(2,53-32)-1?(this._loop=!1,$(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,$(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=la:this._state=yo}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=yo}getData(t){let n=oa;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}n=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&Tf(n,this._mask)}if(this._opcode>7)return this.controlMessage(n);if(this._compressed){this._state=Cf,this.decompress(n,t);return}return n.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(n)),this.dataMessage()}decompress(t,n){this._extensions[na.extensionName].decompress(t,this._fin,(a,l)=>{if(a)return n(a);if(l.length){if(this._messageLength+=l.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return n($(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(l)}let f=this.dataMessage();if(f)return n(f);this.startLoop(n)})}dataMessage(){if(this._fin){let t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let s;this._binaryType==="nodebuffer"?s=bo(n,t):this._binaryType==="arraybuffer"?s=Rf(bo(n,t)):s=n,this.emit("message",s,!0)}else{let s=bo(n,t);if(!this._skipUTF8Validation&&!sa(s))return this._loop=!1,$(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",s,!1)}}this._state=hr}controlMessage(t){if(this._opcode===8)if(this._loop=!1,t.length===0)this.emit("conclude",1005,oa),this.end();else{if(t.length===1)return $(RangeError,"invalid payload length 1",!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");{let n=t.readUInt16BE(0);if(!Ef(n))return $(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let s=t.slice(2);if(!this._skipUTF8Validation&&!sa(s))return $(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",n,s),this.end()}}else this._opcode===9?this.emit("ping",t):this.emit("pong",t);this._state=hr}};fa.exports=ua;function $(o,t,n,s,a){let l=new o(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(l,$),l.code=a,l[Sf]=s,l}});var So=H((Gd,ha)=>{"use strict";var jd=require("net"),Hd=require("tls"),{randomFillSync:Pf}=require("crypto"),ca=cr(),{EMPTY_BUFFER:vf}=je(),{isValidStatusCode:Af}=dr(),{mask:da,toBuffer:ve}=lr(),kf=Buffer.alloc(4),Ae=class{constructor(t,n,s){this._extensions=n||{},s&&(this._generateMask=s,this._maskBuffer=Buffer.alloc(4)),this._socket=t,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(t,n){let s,a=!1,l=2,f=!1;n.mask&&(s=n.maskBuffer||kf,n.generateMask?n.generateMask(s):Pf(s,0,4),f=(s[0]|s[1]|s[2]|s[3])===0,n.readOnly&&!f&&(a=!0),l=6);let m=t.length;t.length>=65536?(l+=8,m=127):t.length>125&&(l+=2,m=126);let d=Buffer.allocUnsafe(a?t.length+l:l);return d[0]=n.fin?n.opcode|128:n.opcode,n.rsv1&&(d[0]|=64),d[1]=m,m===126?d.writeUInt16BE(t.length,2):m===127&&(d[2]=d[3]=0,d.writeUIntBE(t.length,4,6)),n.mask?(d[1]|=128,d[l-4]=s[0],d[l-3]=s[1],d[l-2]=s[2],d[l-1]=s[3],f?[d,t]:a?(da(t,s,d,l,t.length),[d]):(da(t,s,t,0,t.length),[d,t])):[d,t]}close(t,n,s,a){let l;if(t===void 0)l=vf;else{if(typeof t!="number"||!Af(t))throw new TypeError("First argument must be a valid error code number");if(n===void 0||!n.length)l=Buffer.allocUnsafe(2),l.writeUInt16BE(t,0);else{let f=Buffer.byteLength(n);if(f>123)throw new RangeError("The message must not be greater than 123 bytes");l=Buffer.allocUnsafe(2+f),l.writeUInt16BE(t,0),typeof n=="string"?l.write(n,2):l.set(n,2)}}this._deflating?this.enqueue([this.doClose,l,s,a]):this.doClose(l,s,a)}doClose(t,n,s){this.sendFrame(Ae.frame(t,{fin:!0,rsv1:!1,opcode:8,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:!1}),s)}ping(t,n,s){let a=ve(t);if(a.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPing,a,n,ve.readOnly,s]):this.doPing(a,n,ve.readOnly,s)}doPing(t,n,s,a){this.sendFrame(Ae.frame(t,{fin:!0,rsv1:!1,opcode:9,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:s}),a)}pong(t,n,s){let a=ve(t);if(a.length>125)throw new RangeError("The data size must not be greater than 125 bytes");this._deflating?this.enqueue([this.doPong,a,n,ve.readOnly,s]):this.doPong(a,n,ve.readOnly,s)}doPong(t,n,s,a){this.sendFrame(Ae.frame(t,{fin:!0,rsv1:!1,opcode:10,mask:n,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:s}),a)}send(t,n,s){let a=ve(t),l=this._extensions[ca.extensionName],f=n.binary?2:1,m=n.compress;if(this._firstFragment?(this._firstFragment=!1,m&&l&&l.params[l._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(m=a.length>=l._threshold),this._compress=m):(m=!1,f=0),n.fin&&(this._firstFragment=!0),l){let d={fin:n.fin,rsv1:m,opcode:f,mask:n.mask,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:ve.readOnly};this._deflating?this.enqueue([this.dispatch,a,this._compress,d,s]):this.dispatch(a,this._compress,d,s)}else this.sendFrame(Ae.frame(a,{fin:n.fin,rsv1:!1,opcode:f,mask:n.mask,maskBuffer:this._maskBuffer,generateMask:this._generateMask,readOnly:ve.readOnly}),s)}dispatch(t,n,s,a){if(!n){this.sendFrame(Ae.frame(t,s),a);return}let l=this._extensions[ca.extensionName];this._bufferedBytes+=t.length,this._deflating=!0,l.compress(t,s.fin,(f,m)=>{if(this._socket.destroyed){let d=new Error("The socket was closed while data was being compressed");typeof a=="function"&&a(d);for(let h=0;h<this._queue.length;h++){let b=this._queue[h][4];typeof b=="function"&&b(d)}return}this._bufferedBytes-=t.length,this._deflating=!1,s.readOnly=!1,this.sendFrame(Ae.frame(m,s),a),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let t=this._queue.shift();this._bufferedBytes-=t[1].length,Reflect.apply(t[0],this,t.slice(1))}}enqueue(t){this._bufferedBytes+=t[1].length,this._queue.push(t)}sendFrame(t,n){t.length===2?(this._socket.cork(),this._socket.write(t[0]),this._socket.write(t[1],n),this._socket.uncork()):this._socket.write(t[0],n)}};ha.exports=Ae});var Ta=H((Vd,Ra)=>{"use strict";var{kForOnEventAttribute:wo,kListener:ma}=je(),pa=Symbol("kCode"),_a=Symbol("kData"),ba=Symbol("kError"),ya=Symbol("kMessage"),ga=Symbol("kReason"),xt=Symbol("kTarget"),Sa=Symbol("kType"),wa=Symbol("kWasClean"),Ge=class{constructor(t){this[xt]=null,this[Sa]=t}get target(){return this[xt]}get type(){return this[Sa]}};Object.defineProperty(Ge.prototype,"target",{enumerable:!0});Object.defineProperty(Ge.prototype,"type",{enumerable:!0});var Bt=class extends Ge{constructor(t,n={}){super(t);this[pa]=n.code===void 0?0:n.code,this[ga]=n.reason===void 0?"":n.reason,this[wa]=n.wasClean===void 0?!1:n.wasClean}get code(){return this[pa]}get reason(){return this[ga]}get wasClean(){return this[wa]}};Object.defineProperty(Bt.prototype,"code",{enumerable:!0});Object.defineProperty(Bt.prototype,"reason",{enumerable:!0});Object.defineProperty(Bt.prototype,"wasClean",{enumerable:!0});var mr=class extends Ge{constructor(t,n={}){super(t);this[ba]=n.error===void 0?null:n.error,this[ya]=n.message===void 0?"":n.message}get error(){return this[ba]}get message(){return this[ya]}};Object.defineProperty(mr.prototype,"error",{enumerable:!0});Object.defineProperty(mr.prototype,"message",{enumerable:!0});var hn=class extends Ge{constructor(t,n={}){super(t);this[_a]=n.data===void 0?null:n.data}get data(){return this[_a]}};Object.defineProperty(hn.prototype,"data",{enumerable:!0});var xf={addEventListener(o,t,n={}){let s;if(o==="message")s=function(l,f){let m=new hn("message",{data:f?l:l.toString()});m[xt]=this,t.call(this,m)};else if(o==="close")s=function(l,f){let m=new Bt("close",{code:l,reason:f.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});m[xt]=this,t.call(this,m)};else if(o==="error")s=function(l){let f=new mr("error",{error:l,message:l.message});f[xt]=this,t.call(this,f)};else if(o==="open")s=function(){let l=new Ge("open");l[xt]=this,t.call(this,l)};else return;s[wo]=!!n[wo],s[ma]=t,n.once?this.once(o,s):this.on(o,s)},removeEventListener(o,t){for(let n of this.listeners(o))if(n[ma]===t&&!n[wo]){this.removeListener(o,n);break}}};Ra.exports={CloseEvent:Bt,ErrorEvent:mr,Event:Ge,EventTarget:xf,MessageEvent:hn}});var Ro=H((Yd,Ea)=>{"use strict";var{tokenChars:pr}=dr();function be(o,t,n){o[t]===void 0?o[t]=[n]:o[t].push(n)}function Bf(o){let t=Object.create(null),n=Object.create(null),s=!1,a=!1,l=!1,f,m,d=-1,h=-1,b=-1,g=0;for(;g<o.length;g++)if(h=o.charCodeAt(g),f===void 0)if(b===-1&&pr[h]===1)d===-1&&(d=g);else if(g!==0&&(h===32||h===9))b===-1&&d!==-1&&(b=g);else if(h===59||h===44){if(d===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g);let S=o.slice(d,b);h===44?(be(t,S,n),n=Object.create(null)):f=S,d=b=-1}else throw new SyntaxError(`Unexpected character at index ${g}`);else if(m===void 0)if(b===-1&&pr[h]===1)d===-1&&(d=g);else if(h===32||h===9)b===-1&&d!==-1&&(b=g);else if(h===59||h===44){if(d===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g),be(n,o.slice(d,b),!0),h===44&&(be(t,f,n),n=Object.create(null),f=void 0),d=b=-1}else if(h===61&&d!==-1&&b===-1)m=o.slice(d,g),d=b=-1;else throw new SyntaxError(`Unexpected character at index ${g}`);else if(a){if(pr[h]!==1)throw new SyntaxError(`Unexpected character at index ${g}`);d===-1?d=g:s||(s=!0),a=!1}else if(l)if(pr[h]===1)d===-1&&(d=g);else if(h===34&&d!==-1)l=!1,b=g;else if(h===92)a=!0;else throw new SyntaxError(`Unexpected character at index ${g}`);else if(h===34&&o.charCodeAt(g-1)===61)l=!0;else if(b===-1&&pr[h]===1)d===-1&&(d=g);else if(d!==-1&&(h===32||h===9))b===-1&&(b=g);else if(h===59||h===44){if(d===-1)throw new SyntaxError(`Unexpected character at index ${g}`);b===-1&&(b=g);let S=o.slice(d,b);s&&(S=S.replace(/\\/g,""),s=!1),be(n,m,S),h===44&&(be(t,f,n),n=Object.create(null),f=void 0),m=void 0,d=b=-1}else throw new SyntaxError(`Unexpected character at index ${g}`);if(d===-1||l||h===32||h===9)throw new SyntaxError("Unexpected end of input");b===-1&&(b=g);let w=o.slice(d,b);return f===void 0?be(t,w,n):(m===void 0?be(n,w,!0):s?be(n,m,w.replace(/\\/g,"")):be(n,m,w),be(t,f,n)),t}function Of(o){return Object.keys(o).map(t=>{let n=o[t];return Array.isArray(n)||(n=[n]),n.map(s=>[t].concat(Object.keys(s).map(a=>{let l=s[a];return Array.isArray(l)||(l=[l]),l.map(f=>f===!0?a:`${a}=${f}`).join("; ")})).join("; ")).join(", ")}).join(", ")}Ea.exports={format:Of,parse:Bf}});var Ao=H((Xd,Da)=>{"use strict";var Lf=require("events"),Df=require("https"),Wf=require("http"),va=require("net"),If=require("tls"),{randomBytes:Ff,createHash:qf}=require("crypto"),{Readable:Qd}=require("stream"),{URL:To}=require("url"),Ve=cr(),Nf=go(),Mf=So(),{BINARY_TYPES:Ca,EMPTY_BUFFER:mn,GUID:Uf,kForOnEventAttribute:Eo,kListener:$f,kStatusCode:zf,kWebSocket:G,NOOP:Aa}=je(),{EventTarget:{addEventListener:jf,removeEventListener:Hf}}=Ta(),{format:Gf,parse:Vf}=Ro(),{toBuffer:Yf}=lr(),ke=["CONNECTING","OPEN","CLOSING","CLOSED"],Qf=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Co=[8,13],Xf=30*1e3,v=class extends Lf{constructor(t,n,s){super();this._binaryType=Ca[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=mn,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=v.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,t!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,n===void 0?n=[]:Array.isArray(n)||(typeof n=="object"&&n!==null?(s=n,n=[]):n=[n]),ka(this,t,n,s)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(t){!Ca.includes(t)||(this._binaryType=t,this._receiver&&(this._receiver._binaryType=t))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(t,n,s){let a=new Nf({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:s.maxPayload,skipUTF8Validation:s.skipUTF8Validation});this._sender=new Mf(t,this._extensions,s.generateMask),this._receiver=a,this._socket=t,a[G]=this,t[G]=this,a.on("conclude",Zf),a.on("drain",ec),a.on("error",tc),a.on("message",rc),a.on("ping",nc),a.on("pong",oc),t.setTimeout(0),t.setNoDelay(),n.length>0&&t.unshift(n),t.on("close",Ba),t.on("data",pn),t.on("end",Oa),t.on("error",La),this._readyState=v.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=v.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[Ve.extensionName]&&this._extensions[Ve.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=v.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(t,n){if(this.readyState!==v.CLOSED){if(this.readyState===v.CONNECTING){let s="WebSocket was closed before the connection was established";return ie(this,this._req,s)}if(this.readyState===v.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=v.CLOSING,this._sender.close(t,n,!this._isServer,s=>{s||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),Xf)}}pause(){this.readyState===v.CONNECTING||this.readyState===v.CLOSED||(this._paused=!0,this._socket.pause())}ping(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=n=void 0):typeof n=="function"&&(s=n,n=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){vo(this,t,s);return}n===void 0&&(n=!this._isServer),this._sender.ping(t||mn,n,s)}pong(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"?(s=t,t=n=void 0):typeof n=="function"&&(s=n,n=void 0),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){vo(this,t,s);return}n===void 0&&(n=!this._isServer),this._sender.pong(t||mn,n,s)}resume(){this.readyState===v.CONNECTING||this.readyState===v.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(t,n,s){if(this.readyState===v.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof n=="function"&&(s=n,n={}),typeof t=="number"&&(t=t.toString()),this.readyState!==v.OPEN){vo(this,t,s);return}let a=X({binary:typeof t!="string",mask:!this._isServer,compress:!0,fin:!0},n);this._extensions[Ve.extensionName]||(a.compress=!1),this._sender.send(t||mn,a,s)}terminate(){if(this.readyState!==v.CLOSED){if(this.readyState===v.CONNECTING){let t="WebSocket was closed before the connection was established";return ie(this,this._req,t)}this._socket&&(this._readyState=v.CLOSING,this._socket.destroy())}}};Object.defineProperty(v,"CONNECTING",{enumerable:!0,value:ke.indexOf("CONNECTING")});Object.defineProperty(v.prototype,"CONNECTING",{enumerable:!0,value:ke.indexOf("CONNECTING")});Object.defineProperty(v,"OPEN",{enumerable:!0,value:ke.indexOf("OPEN")});Object.defineProperty(v.prototype,"OPEN",{enumerable:!0,value:ke.indexOf("OPEN")});Object.defineProperty(v,"CLOSING",{enumerable:!0,value:ke.indexOf("CLOSING")});Object.defineProperty(v.prototype,"CLOSING",{enumerable:!0,value:ke.indexOf("CLOSING")});Object.defineProperty(v,"CLOSED",{enumerable:!0,value:ke.indexOf("CLOSED")});Object.defineProperty(v.prototype,"CLOSED",{enumerable:!0,value:ke.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(o=>{Object.defineProperty(v.prototype,o,{enumerable:!0})});["open","error","close","message"].forEach(o=>{Object.defineProperty(v.prototype,`on${o}`,{enumerable:!0,get(){for(let t of this.listeners(o))if(t[Eo])return t[$f];return null},set(t){for(let n of this.listeners(o))if(n[Eo]){this.removeListener(o,n);break}typeof t=="function"&&this.addEventListener(o,t,{[Eo]:!0})}})});v.prototype.addEventListener=jf;v.prototype.removeEventListener=Hf;Da.exports=v;function ka(o,t,n,s){let a=Ee(X({protocolVersion:Co[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10},s),{createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,host:void 0,path:void 0,port:void 0});if(!Co.includes(a.protocolVersion))throw new RangeError(`Unsupported protocol version: ${a.protocolVersion} (supported versions: ${Co.join(", ")})`);let l;if(t instanceof To)l=t,o._url=t.href;else{try{l=new To(t)}catch{throw new SyntaxError(`Invalid URL: ${t}`)}o._url=t}let f=l.protocol==="wss:",m=l.protocol==="ws+unix:",d;if(l.protocol!=="ws:"&&!f&&!m?d=`The URL's protocol must be one of "ws:", "wss:", or "ws+unix:"`:m&&!l.pathname?d="The URL's pathname is empty":l.hash&&(d="The URL contains a fragment identifier"),d){let T=new SyntaxError(d);if(o._redirects===0)throw T;Po(o,T);return}let h=f?443:80,b=Ff(16).toString("base64"),g=f?Df.get:Wf.get,w=new Set,S;if(a.createConnection=f?Kf:Jf,a.defaultPort=a.defaultPort||h,a.port=l.port||h,a.host=l.hostname.startsWith("[")?l.hostname.slice(1,-1):l.hostname,a.headers=X({"Sec-WebSocket-Version":a.protocolVersion,"Sec-WebSocket-Key":b,Connection:"Upgrade",Upgrade:"websocket"},a.headers),a.path=l.pathname+l.search,a.timeout=a.handshakeTimeout,a.perMessageDeflate&&(S=new Ve(a.perMessageDeflate!==!0?a.perMessageDeflate:{},!1,a.maxPayload),a.headers["Sec-WebSocket-Extensions"]=Gf({[Ve.extensionName]:S.offer()})),n.length){for(let T of n){if(typeof T!="string"||!Qf.test(T)||w.has(T))throw new SyntaxError("An invalid or duplicated subprotocol was specified");w.add(T)}a.headers["Sec-WebSocket-Protocol"]=n.join(",")}if(a.origin&&(a.protocolVersion<13?a.headers["Sec-WebSocket-Origin"]=a.origin:a.headers.Origin=a.origin),(l.username||l.password)&&(a.auth=`${l.username}:${l.password}`),m){let T=a.path.split(":");a.socketPath=T[0],a.path=T[1]}let y=o._req=g(a);a.timeout&&y.on("timeout",()=>{ie(o,y,"Opening handshake has timed out")}),y.on("error",T=>{y===null||y.aborted||(y=o._req=null,Po(o,T))}),y.on("response",T=>{let P=T.headers.location,A=T.statusCode;if(P&&a.followRedirects&&A>=300&&A<400){if(++o._redirects>a.maxRedirects){ie(o,y,"Maximum redirects exceeded");return}y.abort();let D;try{D=new To(P,t)}catch{let W=new SyntaxError(`Invalid URL: ${P}`);Po(o,W);return}ka(o,D,n,s)}else o.emit("unexpected-response",y,T)||ie(o,y,`Unexpected server response: ${T.statusCode}`)}),y.on("upgrade",(T,P,A)=>{if(o.emit("upgrade",T),o.readyState!==v.CONNECTING)return;y=o._req=null;let D=qf("sha1").update(b+Uf).digest("base64");if(T.headers["sec-websocket-accept"]!==D){ie(o,P,"Invalid Sec-WebSocket-Accept header");return}let N=T.headers["sec-websocket-protocol"],W;if(N!==void 0?w.size?w.has(N)||(W="Server sent an invalid subprotocol"):W="Server sent a subprotocol but none was requested":w.size&&(W="Server sent no subprotocol"),W){ie(o,P,W);return}N&&(o._protocol=N);let M=T.headers["sec-websocket-extensions"];if(M!==void 0){if(!S){ie(o,P,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let I;try{I=Vf(M)}catch{ie(o,P,"Invalid Sec-WebSocket-Extensions header");return}let le=Object.keys(I);if(le.length!==1||le[0]!==Ve.extensionName){ie(o,P,"Server indicated an extension that was not requested");return}try{S.accept(I[Ve.extensionName])}catch{ie(o,P,"Invalid Sec-WebSocket-Extensions header");return}o._extensions[Ve.extensionName]=S}o.setSocket(P,A,{generateMask:a.generateMask,maxPayload:a.maxPayload,skipUTF8Validation:a.skipUTF8Validation})})}function Po(o,t){o._readyState=v.CLOSING,o.emit("error",t),o.emitClose()}function Jf(o){return o.path=o.socketPath,va.connect(o)}function Kf(o){return o.path=void 0,!o.servername&&o.servername!==""&&(o.servername=va.isIP(o.host)?"":o.host),If.connect(o)}function ie(o,t,n){o._readyState=v.CLOSING;let s=new Error(n);Error.captureStackTrace(s,ie),t.setHeader?(t.abort(),t.socket&&!t.socket.destroyed&&t.socket.destroy(),t.once("abort",o.emitClose.bind(o)),o.emit("error",s)):(t.destroy(s),t.once("error",o.emit.bind(o,"error")),t.once("close",o.emitClose.bind(o)))}function vo(o,t,n){if(t){let s=Yf(t).length;o._socket?o._sender._bufferedBytes+=s:o._bufferedAmount+=s}if(n){let s=new Error(`WebSocket is not open: readyState ${o.readyState} (${ke[o.readyState]})`);n(s)}}function Zf(o,t){let n=this[G];n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=o,n._socket[G]!==void 0&&(n._socket.removeListener("data",pn),process.nextTick(xa,n._socket),o===1005?n.close():n.close(o,t))}function ec(){let o=this[G];o.isPaused||o._socket.resume()}function tc(o){let t=this[G];t._socket[G]!==void 0&&(t._socket.removeListener("data",pn),process.nextTick(xa,t._socket),t.close(o[zf])),t.emit("error",o)}function Pa(){this[G].emitClose()}function rc(o,t){this[G].emit("message",o,t)}function nc(o){let t=this[G];t.pong(o,!t._isServer,Aa),t.emit("ping",o)}function oc(o){this[G].emit("pong",o)}function xa(o){o.resume()}function Ba(){let o=this[G];this.removeListener("close",Ba),this.removeListener("data",pn),this.removeListener("end",Oa),o._readyState=v.CLOSING;let t;!this._readableState.endEmitted&&!o._closeFrameReceived&&!o._receiver._writableState.errorEmitted&&(t=o._socket.read())!==null&&o._receiver.write(t),o._receiver.end(),this[G]=void 0,clearTimeout(o._closeTimer),o._receiver._writableState.finished||o._receiver._writableState.errorEmitted?o.emitClose():(o._receiver.on("error",Pa),o._receiver.on("finish",Pa))}function pn(o){this[G]._receiver.write(o)||this.pause()}function Oa(){let o=this[G];o._readyState=v.CLOSING,o._receiver.end(),this.end()}function La(){let o=this[G];this.removeListener("error",La),this.on("error",Aa),o&&(o._readyState=v.CLOSING,this.destroy())}});var qa=H((Jd,Fa)=>{"use strict";var{Duplex:sc}=require("stream");function Wa(o){o.emit("close")}function ic(){!this.destroyed&&this._writableState.finished&&this.destroy()}function Ia(o){this.removeListener("error",Ia),this.destroy(),this.listenerCount("error")===0&&this.emit("error",o)}function ac(o,t){let n=!0,s=new sc(Ee(X({},t),{autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1}));return o.on("message",function(l,f){let m=!f&&s._readableState.objectMode?l.toString():l;s.push(m)||o.pause()}),o.once("error",function(l){s.destroyed||(n=!1,s.destroy(l))}),o.once("close",function(){s.destroyed||s.push(null)}),s._destroy=function(a,l){if(o.readyState===o.CLOSED){l(a),process.nextTick(Wa,s);return}let f=!1;o.once("error",function(d){f=!0,l(d)}),o.once("close",function(){f||l(a),process.nextTick(Wa,s)}),n&&o.terminate()},s._final=function(a){if(o.readyState===o.CONNECTING){o.once("open",function(){s._final(a)});return}o._socket!==null&&(o._socket._writableState.finished?(a(),s._readableState.endEmitted&&s.destroy()):(o._socket.once("finish",function(){a()}),o.close()))},s._read=function(){o.isPaused&&o.resume()},s._write=function(a,l,f){if(o.readyState===o.CONNECTING){o.once("open",function(){s._write(a,l,f)});return}o.send(a,f)},s.on("end",ic),s.on("error",Ia),s}Fa.exports=ac});var Ma=H((Kd,Na)=>{"use strict";var{tokenChars:lc}=dr();function uc(o){let t=new Set,n=-1,s=-1,a=0;for(a;a<o.length;a++){let f=o.charCodeAt(a);if(s===-1&&lc[f]===1)n===-1&&(n=a);else if(a!==0&&(f===32||f===9))s===-1&&n!==-1&&(s=a);else if(f===44){if(n===-1)throw new SyntaxError(`Unexpected character at index ${a}`);s===-1&&(s=a);let m=o.slice(n,s);if(t.has(m))throw new SyntaxError(`The "${m}" subprotocol is duplicated`);t.add(m),n=s=-1}else throw new SyntaxError(`Unexpected character at index ${a}`)}if(n===-1||s!==-1)throw new SyntaxError("Unexpected end of input");let l=o.slice(n,a);if(t.has(l))throw new SyntaxError(`The "${l}" subprotocol is duplicated`);return t.add(l),t}Na.exports={parse:uc}});var Va=H((rh,Ga)=>{"use strict";var fc=require("events"),_n=require("http"),Zd=require("https"),eh=require("net"),th=require("tls"),{createHash:cc}=require("crypto"),Ua=Ro(),at=cr(),dc=Ma(),hc=Ao(),{GUID:mc,kWebSocket:pc}=je(),_c=/^[+/0-9A-Za-z]{22}==$/,$a=0,za=1,ja=2,Ha=class extends fc{constructor(t,n){super();if(t=X({maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null},t),t.port==null&&!t.server&&!t.noServer||t.port!=null&&(t.server||t.noServer)||t.server&&t.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(t.port!=null?(this._server=_n.createServer((s,a)=>{let l=_n.STATUS_CODES[426];a.writeHead(426,{"Content-Length":l.length,"Content-Type":"text/plain"}),a.end(l)}),this._server.listen(t.port,t.host,t.backlog,n)):t.server&&(this._server=t.server),this._server){let s=this.emit.bind(this,"connection");this._removeListeners=bc(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(a,l,f)=>{this.handleUpgrade(a,l,f,s)}})}t.perMessageDeflate===!0&&(t.perMessageDeflate={}),t.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=t,this._state=$a}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(t){if(this._state===ja){t&&this.once("close",()=>{t(new Error("The server is not running"))}),process.nextTick(_r,this);return}if(t&&this.once("close",t),this._state!==za)if(this._state=za,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(_r,this):process.nextTick(_r,this);else{let n=this._server;this._removeListeners(),this._removeListeners=this._server=null,n.close(()=>{_r(this)})}}shouldHandle(t){if(this.options.path){let n=t.url.indexOf("?");if((n!==-1?t.url.slice(0,n):t.url)!==this.options.path)return!1}return!0}handleUpgrade(t,n,s,a){n.on("error",ko);let l=t.headers["sec-websocket-key"]!==void 0?t.headers["sec-websocket-key"]:!1,f=+t.headers["sec-websocket-version"];if(t.method!=="GET"||t.headers.upgrade.toLowerCase()!=="websocket"||!l||!_c.test(l)||f!==8&&f!==13||!this.shouldHandle(t))return Ot(n,400);let m=t.headers["sec-websocket-protocol"],d=new Set;if(m!==void 0)try{d=dc.parse(m)}catch{return Ot(n,400)}let h=t.headers["sec-websocket-extensions"],b={};if(this.options.perMessageDeflate&&h!==void 0){let g=new at(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let w=Ua.parse(h);w[at.extensionName]&&(g.accept(w[at.extensionName]),b[at.extensionName]=g)}catch{return Ot(n,400)}}if(this.options.verifyClient){let g={origin:t.headers[`${f===8?"sec-websocket-origin":"origin"}`],secure:!!(t.socket.authorized||t.socket.encrypted),req:t};if(this.options.verifyClient.length===2){this.options.verifyClient(g,(w,S,y,T)=>{if(!w)return Ot(n,S||401,y,T);this.completeUpgrade(b,l,d,t,n,s,a)});return}if(!this.options.verifyClient(g))return Ot(n,401)}this.completeUpgrade(b,l,d,t,n,s,a)}completeUpgrade(t,n,s,a,l,f,m){if(!l.readable||!l.writable)return l.destroy();if(l[pc])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>$a)return Ot(l,503);let d=cc("sha1").update(n+mc).digest("base64"),h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${d}`],b=new hc(null);if(s.size){let g=this.options.handleProtocols?this.options.handleProtocols(s,a):s.values().next().value;g&&(h.push(`Sec-WebSocket-Protocol: ${g}`),b._protocol=g)}if(t[at.extensionName]){let g=t[at.extensionName].params,w=Ua.format({[at.extensionName]:[g]});h.push(`Sec-WebSocket-Extensions: ${w}`),b._extensions=t}this.emit("headers",h,a),l.write(h.concat(`\r
`).join(`\r
`)),l.removeListener("error",ko),b.setSocket(l,f,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(b),b.on("close",()=>{this.clients.delete(b),this._shouldEmitClose&&!this.clients.size&&process.nextTick(_r,this)})),m(b,a)}};Ga.exports=Ha;function bc(o,t){for(let n of Object.keys(t))o.on(n,t[n]);return function(){for(let s of Object.keys(t))o.removeListener(s,t[s])}}function _r(o){o._state=ja,o.emit("close")}function ko(){this.destroy()}function Ot(o,t,n,s){o.writable&&(n=n||_n.STATUS_CODES[t],s=X({Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(n)},s),o.write(`HTTP/1.1 ${t} ${_n.STATUS_CODES[t]}\r
`+Object.keys(s).map(a=>`${a}: ${s[a]}`).join(`\r
`)+`\r
\r
`+n)),o.removeListener("error",ko),o.destroy()}});var Qa=H((nh,Ya)=>{"use strict";var xe=Ao();xe.createWebSocketStream=qa();xe.Server=Va();xe.Receiver=go();xe.Sender=So();xe.WebSocket=xe;xe.WebSocketServer=xe.Server;Ya.exports=xe});var Ac={};ti(Ac,{default:()=>il});var ft=require("@raycast/api");var C=require("@raycast/api"),kt=require("react");var $e=require("@raycast/api");var Oi=rt(require("node:http"),1),Li=rt(require("node:https"),1),it=rt(require("node:zlib"),1),te=rt(require("node:stream"),1);function Mu(o){if(!/^data:/i.test(o))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');o=o.replace(/\r?\n/g,"");let t=o.indexOf(",");if(t===-1||t<=4)throw new TypeError("malformed data: URI");let n=o.substring(5,t).split(";"),s="",a=!1,l=n[0]||"text/plain",f=l;for(let b=1;b<n.length;b++)n[b]==="base64"?a=!0:(f+=`;${n[b]}`,n[b].indexOf("charset=")===0&&(s=n[b].substring(8)));!n[0]&&!s.length&&(f+=";charset=US-ASCII",s="US-ASCII");let m=a?"base64":"ascii",d=unescape(o.substring(t+1)),h=Buffer.from(d,m);return h.type=l,h.typeFull=f,h.charset=s,h}var ni=Mu;var he=rt(require("node:stream"),1),Et=require("node:util");Kt();ro();var Ne=class extends Error{constructor(t,n){super(t);Error.captureStackTrace(this,this.constructor),this.type=n}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};var oe=class extends Ne{constructor(t,n,s){super(t,n);s&&(this.code=this.errno=s.code,this.erroredSysCall=s.syscall)}};var Kr=Symbol.toStringTag,no=o=>typeof o=="object"&&typeof o.append=="function"&&typeof o.delete=="function"&&typeof o.get=="function"&&typeof o.getAll=="function"&&typeof o.has=="function"&&typeof o.set=="function"&&typeof o.sort=="function"&&o[Kr]==="URLSearchParams",tr=o=>o&&typeof o=="object"&&typeof o.arrayBuffer=="function"&&typeof o.type=="string"&&typeof o.stream=="function"&&typeof o.constructor=="function"&&/^(Blob|File)$/.test(o[Kr]),di=o=>typeof o=="object"&&(o[Kr]==="AbortSignal"||o[Kr]==="EventTarget");var J=Symbol("Body internals"),Ce=class{constructor(t,{size:n=0}={}){let s=null;t===null?t=null:no(t)?t=Buffer.from(t.toString()):tr(t)||Buffer.isBuffer(t)||(Et.types.isAnyArrayBuffer(t)?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof he.default||(t instanceof Tt?(t=ci(t),s=t.type.split("=")[1]):t=Buffer.from(String(t))));let a=t;Buffer.isBuffer(t)?a=he.default.Readable.from(t):tr(t)&&(a=he.default.Readable.from(t.stream())),this[J]={body:t,stream:a,boundary:s,disturbed:!1,error:null},this.size=n,t instanceof he.default&&t.on("error",l=>{let f=l instanceof Ne?l:new oe(`Invalid response body while trying to fetch ${this.url}: ${l.message}`,"system",l);this[J].error=f})}get body(){return this[J].stream}get bodyUsed(){return this[J].disturbed}async arrayBuffer(){let{buffer:t,byteOffset:n,byteLength:s}=await tn(this);return t.slice(n,n+s)}async formData(){let t=this.headers.get("content-type");if(t.startsWith("application/x-www-form-urlencoded")){let s=new Tt,a=new URLSearchParams(await this.text());for(let[l,f]of a)s.append(l,f);return s}let{toFormData:n}=await Promise.resolve().then(()=>(yi(),bi));return n(this.body,t)}async blob(){let t=this.headers&&this.headers.get("content-type")||this[J].body&&this[J].body.type||"",n=await this.buffer();return new nt([n],{type:t})}async json(){let t=await tn(this);return JSON.parse(t.toString())}async text(){return(await tn(this)).toString()}buffer(){return tn(this)}};Ce.prototype.buffer=(0,Et.deprecate)(Ce.prototype.buffer,"Please use 'response.arrayBuffer()' instead of 'response.buffer()'","node-fetch#buffer");Object.defineProperties(Ce.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});async function tn(o){if(o[J].disturbed)throw new TypeError(`body used already for: ${o.url}`);if(o[J].disturbed=!0,o[J].error)throw o[J].error;let{body:t}=o;if(t===null||!(t instanceof he.default))return Buffer.alloc(0);let n=[],s=0;try{for await(let a of t){if(o.size>0&&s+a.length>o.size){let l=new oe(`content size at ${o.url} over limit: ${o.size}`,"max-size");throw t.destroy(l),l}s+=a.length,n.push(a)}}catch(a){throw a instanceof Ne?a:new oe(`Invalid response body while trying to fetch ${o.url}: ${a.message}`,"system",a)}if(t.readableEnded===!0||t._readableState.ended===!0)try{return n.every(a=>typeof a=="string")?Buffer.from(n.join("")):Buffer.concat(n,s)}catch(a){throw new oe(`Could not create Buffer from response body for ${o.url}: ${a.message}`,"system",a)}else throw new oe(`Premature close of server response while trying to fetch ${o.url}`)}var Ct=(o,t)=>{let n,s,{body:a}=o[J];if(o.bodyUsed)throw new Error("cannot clone body after it is used");return a instanceof he.default&&typeof a.getBoundary!="function"&&(n=new he.PassThrough({highWaterMark:t}),s=new he.PassThrough({highWaterMark:t}),a.pipe(n),a.pipe(s),o[J].stream=n,a=s),a},rf=(0,Et.deprecate)(o=>o.getBoundary(),"form-data doesn't follow the spec and requires special treatment. Use alternative package","https://github.com/node-fetch/node-fetch/issues/1167"),rn=(o,t)=>o===null?null:typeof o=="string"?"text/plain;charset=UTF-8":no(o)?"application/x-www-form-urlencoded;charset=UTF-8":tr(o)?o.type||null:Buffer.isBuffer(o)||Et.types.isAnyArrayBuffer(o)||ArrayBuffer.isView(o)?null:o instanceof Tt?`multipart/form-data; boundary=${t[J].boundary}`:o&&typeof o.getBoundary=="function"?`multipart/form-data;boundary=${rf(o)}`:o instanceof he.default?null:"text/plain;charset=UTF-8",gi=o=>{let{body:t}=o[J];return t===null?0:tr(t)?t.size:Buffer.isBuffer(t)?t.length:t&&typeof t.getLengthSync=="function"&&t.hasKnownLength&&t.hasKnownLength()?t.getLengthSync():null},Si=(o,{body:t})=>{t===null?o.end():t.pipe(o)};var so=require("node:util"),or=rt(require("node:http"),1),nn=typeof or.default.validateHeaderName=="function"?or.default.validateHeaderName:o=>{if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(o)){let t=new TypeError(`Header name must be a valid HTTP token [${o}]`);throw Object.defineProperty(t,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),t}},io=typeof or.default.validateHeaderValue=="function"?or.default.validateHeaderValue:(o,t)=>{if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(t)){let n=new TypeError(`Invalid character in header content ["${o}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}},ee=class extends URLSearchParams{constructor(t){let n=[];if(t instanceof ee){let s=t.raw();for(let[a,l]of Object.entries(s))n.push(...l.map(f=>[a,f]))}else if(t!=null)if(typeof t=="object"&&!so.types.isBoxedPrimitive(t)){let s=t[Symbol.iterator];if(s==null)n.push(...Object.entries(t));else{if(typeof s!="function")throw new TypeError("Header pairs must be iterable");n=[...t].map(a=>{if(typeof a!="object"||so.types.isBoxedPrimitive(a))throw new TypeError("Each header pair must be an iterable object");return[...a]}).map(a=>{if(a.length!==2)throw new TypeError("Each header pair must be a name/value tuple");return[...a]})}}else throw new TypeError("Failed to construct 'Headers': The provided value is not of type '(sequence<sequence<ByteString>> or record<ByteString, ByteString>)");n=n.length>0?n.map(([s,a])=>(nn(s),io(s,String(a)),[String(s).toLowerCase(),String(a)])):void 0;super(n);return new Proxy(this,{get(s,a,l){switch(a){case"append":case"set":return(f,m)=>(nn(f),io(f,String(m)),URLSearchParams.prototype[a].call(s,String(f).toLowerCase(),String(m)));case"delete":case"has":case"getAll":return f=>(nn(f),URLSearchParams.prototype[a].call(s,String(f).toLowerCase()));case"keys":return()=>(s.sort(),new Set(URLSearchParams.prototype.keys.call(s)).keys());default:return Reflect.get(s,a,l)}}})}get[Symbol.toStringTag](){return this.constructor.name}toString(){return Object.prototype.toString.call(this)}get(t){let n=this.getAll(t);if(n.length===0)return null;let s=n.join(", ");return/^content-encoding$/i.test(t)&&(s=s.toLowerCase()),s}forEach(t,n=void 0){for(let s of this.keys())Reflect.apply(t,n,[this.get(s),s,this])}*values(){for(let t of this.keys())yield this.get(t)}*entries(){for(let t of this.keys())yield[t,this.get(t)]}[Symbol.iterator](){return this.entries()}raw(){return[...this.keys()].reduce((t,n)=>(t[n]=this.getAll(n),t),{})}[Symbol.for("nodejs.util.inspect.custom")](){return[...this.keys()].reduce((t,n)=>{let s=this.getAll(n);return n==="host"?t[n]=s[0]:t[n]=s.length>1?s:s[0],t},{})}};Object.defineProperties(ee.prototype,["get","entries","forEach","values"].reduce((o,t)=>(o[t]={enumerable:!0},o),{}));function wi(o=[]){return new ee(o.reduce((t,n,s,a)=>(s%2===0&&t.push(a.slice(s,s+2)),t),[]).filter(([t,n])=>{try{return nn(t),io(t,String(n)),!0}catch{return!1}}))}var nf=new Set([301,302,303,307,308]),on=o=>nf.has(o);var me=Symbol("Response internals"),K=class extends Ce{constructor(t=null,n={}){super(t,n);let s=n.status!=null?n.status:200,a=new ee(n.headers);if(t!==null&&!a.has("Content-Type")){let l=rn(t,this);l&&a.append("Content-Type",l)}this[me]={type:"default",url:n.url,status:s,statusText:n.statusText||"",headers:a,counter:n.counter,highWaterMark:n.highWaterMark}}get type(){return this[me].type}get url(){return this[me].url||""}get status(){return this[me].status}get ok(){return this[me].status>=200&&this[me].status<300}get redirected(){return this[me].counter>0}get statusText(){return this[me].statusText}get headers(){return this[me].headers}get highWaterMark(){return this[me].highWaterMark}clone(){return new K(Ct(this,this.highWaterMark),{type:this.type,url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected,size:this.size,highWaterMark:this.highWaterMark})}static redirect(t,n=302){if(!on(n))throw new RangeError('Failed to execute "redirect" on "response": Invalid status code');return new K(null,{headers:{location:new URL(t).toString()},status:n})}static error(){let t=new K(null,{status:0,statusText:""});return t[me].type="error",t}get[Symbol.toStringTag](){return"Response"}};Object.defineProperties(K.prototype,{type:{enumerable:!0},url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});var xi=require("node:url");var Ri=o=>{if(o.search)return o.search;let t=o.href.length-1,n=o.hash||(o.href[t]==="#"?"#":"");return o.href[t-n.length]==="?"?"?":""};var Ei=require("net");function Ti(o,t=!1){return o==null||(o=new URL(o),/^(about|blob|data):$/.test(o.protocol))?"no-referrer":(o.username="",o.password="",o.hash="",t&&(o.pathname="",o.search=""),o)}var Ci=new Set(["","no-referrer","no-referrer-when-downgrade","same-origin","origin","strict-origin","origin-when-cross-origin","strict-origin-when-cross-origin","unsafe-url"]),Pi="strict-origin-when-cross-origin";function vi(o){if(!Ci.has(o))throw new TypeError(`Invalid referrerPolicy: ${o}`);return o}function of(o){if(/^(http|ws)s:$/.test(o.protocol))return!0;let t=o.host.replace(/(^\[)|(]$)/g,""),n=(0,Ei.isIP)(t);return n===4&&/^127\./.test(t)||n===6&&/^(((0+:){7})|(::(0+:){0,6}))0*1$/.test(t)?!0:/^(.+\.)*localhost$/.test(o.host)?!1:o.protocol==="file:"}function Pt(o){return/^about:(blank|srcdoc)$/.test(o)||o.protocol==="data:"||/^(blob|filesystem):$/.test(o.protocol)?!0:of(o)}function Ai(o,{referrerURLCallback:t,referrerOriginCallback:n}={}){if(o.referrer==="no-referrer"||o.referrerPolicy==="")return null;let s=o.referrerPolicy;if(o.referrer==="about:client")return"no-referrer";let a=o.referrer,l=Ti(a),f=Ti(a,!0);l.toString().length>4096&&(l=f),t&&(l=t(l)),n&&(f=n(f));let m=new URL(o.url);switch(s){case"no-referrer":return"no-referrer";case"origin":return f;case"unsafe-url":return l;case"strict-origin":return Pt(l)&&!Pt(m)?"no-referrer":f.toString();case"strict-origin-when-cross-origin":return l.origin===m.origin?l:Pt(l)&&!Pt(m)?"no-referrer":f;case"same-origin":return l.origin===m.origin?l:"no-referrer";case"origin-when-cross-origin":return l.origin===m.origin?l:f;case"no-referrer-when-downgrade":return Pt(l)&&!Pt(m)?"no-referrer":l;default:throw new TypeError(`Invalid referrerPolicy: ${s}`)}}function ki(o){let t=(o.get("referrer-policy")||"").split(/[,\s]+/),n="";for(let s of t)s&&Ci.has(s)&&(n=s);return n}var j=Symbol("Request internals"),sn=o=>typeof o=="object"&&typeof o[j]=="object",Ue=class extends Ce{constructor(t,n={}){let s;if(sn(t)?s=new URL(t.url):(s=new URL(t),t={}),s.username!==""||s.password!=="")throw new TypeError(`${s} is an url with embedded credentails.`);let a=n.method||t.method||"GET";if(a=a.toUpperCase(),(n.body!=null||sn(t))&&t.body!==null&&(a==="GET"||a==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let l=n.body?n.body:sn(t)&&t.body!==null?Ct(t):null;super(l,{size:n.size||t.size||0});let f=new ee(n.headers||t.headers||{});if(l!==null&&!f.has("Content-Type")){let h=rn(l,this);h&&f.set("Content-Type",h)}let m=sn(t)?t.signal:null;if("signal"in n&&(m=n.signal),m!=null&&!di(m))throw new TypeError("Expected signal to be an instanceof AbortSignal or EventTarget");let d=n.referrer==null?t.referrer:n.referrer;if(d==="")d="no-referrer";else if(d){let h=new URL(d);d=/^about:(\/\/)?client$/.test(h)?"client":h}else d=void 0;this[j]={method:a,redirect:n.redirect||t.redirect||"follow",headers:f,parsedURL:s,signal:m,referrer:d},this.follow=n.follow===void 0?t.follow===void 0?20:t.follow:n.follow,this.compress=n.compress===void 0?t.compress===void 0?!0:t.compress:n.compress,this.counter=n.counter||t.counter||0,this.agent=n.agent||t.agent,this.highWaterMark=n.highWaterMark||t.highWaterMark||16384,this.insecureHTTPParser=n.insecureHTTPParser||t.insecureHTTPParser||!1,this.referrerPolicy=n.referrerPolicy||t.referrerPolicy||""}get method(){return this[j].method}get url(){return(0,xi.format)(this[j].parsedURL)}get headers(){return this[j].headers}get redirect(){return this[j].redirect}get signal(){return this[j].signal}get referrer(){if(this[j].referrer==="no-referrer")return"";if(this[j].referrer==="client")return"about:client";if(this[j].referrer)return this[j].referrer.toString()}get referrerPolicy(){return this[j].referrerPolicy}set referrerPolicy(t){this[j].referrerPolicy=vi(t)}clone(){return new Ue(this)}get[Symbol.toStringTag](){return"Request"}};Object.defineProperties(Ue.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0},referrer:{enumerable:!0},referrerPolicy:{enumerable:!0}});var Bi=o=>{let{parsedURL:t}=o[j],n=new ee(o[j].headers);n.has("Accept")||n.set("Accept","*/*");let s=null;if(o.body===null&&/^(post|put)$/i.test(o.method)&&(s="0"),o.body!==null){let m=gi(o);typeof m=="number"&&!Number.isNaN(m)&&(s=String(m))}s&&n.set("Content-Length",s),o.referrerPolicy===""&&(o.referrerPolicy=Pi),o.referrer&&o.referrer!=="no-referrer"?o[j].referrer=Ai(o):o[j].referrer="no-referrer",o[j].referrer instanceof URL&&n.set("Referer",o.referrer),n.has("User-Agent")||n.set("User-Agent","node-fetch"),o.compress&&!n.has("Accept-Encoding")&&n.set("Accept-Encoding","gzip,deflate,br");let{agent:a}=o;typeof a=="function"&&(a=a(t)),!n.has("Connection")&&!a&&n.set("Connection","close");let l=Ri(t),f={path:t.pathname+l,method:o.method,headers:n[Symbol.for("nodejs.util.inspect.custom")](),insecureHTTPParser:o.insecureHTTPParser,agent:a};return{parsedURL:t,options:f}};var ao=class extends Ne{constructor(t,n="aborted"){super(t,n)}};var sf=new Set(["data:","http:","https:"]);async function an(o,t){return new Promise((n,s)=>{let a=new Ue(o,t),{parsedURL:l,options:f}=Bi(a);if(!sf.has(l.protocol))throw new TypeError(`node-fetch cannot load ${o}. URL scheme "${l.protocol.replace(/:$/,"")}" is not supported.`);if(l.protocol==="data:"){let y=ni(a.url),T=new K(y,{headers:{"Content-Type":y.typeFull}});n(T);return}let m=(l.protocol==="https:"?Li.default:Oi.default).request,{signal:d}=a,h=null,b=()=>{let y=new ao("The operation was aborted.");s(y),a.body&&a.body instanceof te.default.Readable&&a.body.destroy(y),!(!h||!h.body)&&h.body.emit("error",y)};if(d&&d.aborted){b();return}let g=()=>{b(),S()},w=m(l,f);d&&d.addEventListener("abort",g);let S=()=>{w.abort(),d&&d.removeEventListener("abort",g)};w.on("error",y=>{s(new oe(`request to ${a.url} failed, reason: ${y.message}`,"system",y)),S()}),af(w,y=>{h.body.destroy(y)}),process.version<"v14"&&w.on("socket",y=>{let T;y.prependListener("end",()=>{T=y._eventsCount}),y.prependListener("close",P=>{if(h&&T<y._eventsCount&&!P){let A=new Error("Premature close");A.code="ERR_STREAM_PREMATURE_CLOSE",h.body.emit("error",A)}})}),w.on("response",y=>{w.setTimeout(0);let T=wi(y.rawHeaders);if(on(y.statusCode)){let W=T.get("Location"),M=W===null?null:new URL(W,a.url);switch(a.redirect){case"error":s(new oe(`uri requested responds with a redirect, redirect mode is set to error: ${a.url}`,"no-redirect")),S();return;case"manual":M!==null&&T.set("Location",M);break;case"follow":{if(M===null)break;if(a.counter>=a.follow){s(new oe(`maximum redirect reached at: ${a.url}`,"max-redirect")),S();return}let I={headers:new ee(a.headers),follow:a.follow,counter:a.counter+1,agent:a.agent,compress:a.compress,method:a.method,body:Ct(a),signal:a.signal,size:a.size,referrer:a.referrer,referrerPolicy:a.referrerPolicy};if(y.statusCode!==303&&a.body&&t.body instanceof te.default.Readable){s(new oe("Cannot follow redirect with body being a readable stream","unsupported-redirect")),S();return}(y.statusCode===303||(y.statusCode===301||y.statusCode===302)&&a.method==="POST")&&(I.method="GET",I.body=void 0,I.headers.delete("content-length"));let le=ki(T);le&&(I.referrerPolicy=le),n(an(new Ue(M,I))),S();return}default:return s(new TypeError(`Redirect option '${a.redirect}' is not a valid value of RequestRedirect`))}}d&&y.once("end",()=>{d.removeEventListener("abort",g)});let P=(0,te.pipeline)(y,new te.PassThrough,s);process.version<"v12.10"&&y.on("aborted",g);let A={url:a.url,status:y.statusCode,statusText:y.statusMessage,headers:T,size:a.size,counter:a.counter,highWaterMark:a.highWaterMark},D=T.get("Content-Encoding");if(!a.compress||a.method==="HEAD"||D===null||y.statusCode===204||y.statusCode===304){h=new K(P,A),n(h);return}let N={flush:it.default.Z_SYNC_FLUSH,finishFlush:it.default.Z_SYNC_FLUSH};if(D==="gzip"||D==="x-gzip"){P=(0,te.pipeline)(P,it.default.createGunzip(N),s),h=new K(P,A),n(h);return}if(D==="deflate"||D==="x-deflate"){(0,te.pipeline)(y,new te.PassThrough,s).once("data",M=>{P=(M[0]&15)===8?(0,te.pipeline)(P,it.default.createInflate(),s):(0,te.pipeline)(P,it.default.createInflateRaw(),s),h=new K(P,A),n(h)});return}if(D==="br"){P=(0,te.pipeline)(P,it.default.createBrotliDecompress(),s),h=new K(P,A),n(h);return}h=new K(P,A),n(h)}),Si(w,a)})}function af(o,t){let n=Buffer.from(`0\r
\r
`),s=!1,a=!1,l;o.on("response",f=>{let{headers:m}=f;s=m["transfer-encoding"]==="chunked"&&!m["content-length"]}),o.on("socket",f=>{let m=()=>{if(s&&!a){let d=new Error("Premature close");d.code="ERR_STREAM_PREMATURE_CLOSE",t(d)}};f.prependListener("close",m),o.on("abort",()=>{f.removeListener("close",m)}),f.on("data",d=>{a=Buffer.compare(d.slice(-5),n)===0,!a&&l&&(a=Buffer.compare(l.slice(-3),n.slice(0,3))===0&&Buffer.compare(d.slice(-2),n.slice(3))===0),l=d})})}var uo=require("url");var vt=require("@raycast/api");var sr=new Error("No avaliable backend"),lo=new Error("Current backend deleted"),se=function(o){switch(o){case sr:{(0,vt.showToast)(vt.Toast.Style.Failure,sr.message,"Configure in 'Backends'");break}case lo:{(0,vt.showToast)(vt.Toast.Style.Failure,sr.message,"Configure in 'Backends'");break}default:console.error(o),ir("Request failed",o)}};var Di=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];function ze(o){if(o<1e3)return o+" B";let t=Math.min(Math.floor(Math.log10(o)/3),Di.length-1);o=Number((o/Math.pow(1e3,t)).toPrecision(3));let n=Di[t];return o+" "+n}async function fo(){return await $e.LocalStorage.getItem("current")}async function lf(o){return await $e.LocalStorage.getItem(o)}async function ln(){let o=await fo();if(o){let t=await lf(o);if(t==null)throw lo;return[o,t]}else throw sr}async function At({endpoint:o,method:t="GET",body:n}){let[s,a]=await ln(),l=new uo.URL(s),f=`${Ii(l.href)}${o}`;return an(f,{method:t,headers:a?{Authorization:`Bearer ${a}`}:{},body:n?JSON.stringify(n):void 0})}async function Wi(o,t={}){let[n,s]=await ln(),a=new uo.URL(n);a.protocol==="https:"?a.protocol="wss:":a.protocol="ws:";let l=new URLSearchParams(t);l.set("token",s);let f="?"+l.toString();return`${Ii(a.href)}${o}${f}`}function Ii(o){return o.replace(/\/$/,"")}async function co(o){await $e.LocalStorage.setItem("current",o)}async function ir(o,t){console.error(o,t),await(0,$e.showToast)($e.Toast.Style.Failure,o,t instanceof Error?t.message:t.toString())}function Fi(o){return new Promise(t=>setTimeout(t,o))}function ar(o,t){let n=String(o);for(;n.length<t;)n="0"+n;return n}function uf(o){let t=o.getFullYear()%100,n=ar(o.getMonth()+1,2),s=ar(o.getDate(),2),a=ar(o.getHours(),2),l=ar(o.getMinutes(),2),f=ar(o.getSeconds(),2);return`${t}-${n}-${s} ${a}:${l}:${f}`}function qi(){return uf(new Date).toString()}function Ni(o){return o.charAt(0).toUpperCase()+o.slice(1)}async function ff(){return await C.LocalStorage.allItems()}async function cf(o,t){await C.LocalStorage.setItem(o,t)}async function df(o){await C.LocalStorage.removeItem(o)}function ho(){let[o,t]=(0,kt.useState)(0),{pop:n}=(0,C.useNavigation)(),[s,a]=(0,kt.useState)({}),[l,f]=(0,kt.useState)("");(0,kt.useEffect)(()=>{(async()=>{let h=await fo();h&&f(h);let b=await ff();a(b)})()},[o]);let m=Object.entries(s).filter(([d])=>d!="current").sort((d,h)=>d[0].localeCompare(h[0]));return _jsx(C.List,null,m.map(([d,h],b)=>_jsx(C.List.Item,{title:d,icon:{source:C.Icon.Circle,tintColor:d==l?C.Color.Green:C.Color.PrimaryText},key:b,subtitle:h&&h.length!=0?h:"(no secret)",accessoryTitle:d==l?"Current":"",actions:_jsx(C.ActionPanel,null,_jsx(C.Action,{title:"Use Backend",onAction:async()=>{await co(d),f(d)}}),_jsx(C.Action,{title:"Remove",onAction:async()=>{await(0,C.confirmAlert)({title:"Delete this backend?",primaryAction:{title:"Confirm",onAction:async()=>{await df(d),t(w=>w+1),(0,C.showToast)(C.Toast.Style.Success,"Delete Success",d)}}})}}))})),_jsx(C.List.Item,{title:"Add Backend",icon:{source:C.Icon.Plus,tintColor:C.Color.Blue},key:m.length,actions:_jsx(C.ActionPanel,null,_jsx(C.Action.Push,{title:"Add Backend",target:_jsx(C.Form,{actions:_jsx(C.ActionPanel,null,_jsx(C.Action.SubmitForm,{title:"Submit",onSubmit:async d=>{d.url.startsWith("http://")||d.url.startsWith("https://")?(await cf(d.url,d.secret),await co(d.url),f(d.url),t(h=>h+1),(0,C.showToast)(C.Toast.Style.Success,"Add Success",d.url),n()):await(0,C.showToast)(C.Toast.Style.Failure,"invalid url")}}))},_jsx(C.Form.TextField,{id:"url",title:"url",defaultValue:"http://127.0.0.1:9090"}),_jsx(C.Form.TextField,{id:"secret",title:"secret",defaultValue:""}))}))}),_jsx(C.List.Item,{title:"Delete All Data",icon:{source:C.Icon.Trash,tintColor:C.Color.Red},key:m.length+1,actions:_jsx(C.ActionPanel,null,_jsx(C.Action,{title:"Remove",onAction:async()=>{await(0,C.confirmAlert)({title:"Delete All Data?",primaryAction:{title:"Confirm",onAction:async()=>{await C.LocalStorage.clear(),t(h=>h+1),(0,C.showToast)(C.Toast.Style.Success,"Delete Success")}}})}}))}))}var lt=require("@raycast/api"),Ka=require("react");var Be=require("react");var ye=require("react");var yc=Qa(),xo=[{key:0,value:"connecting"},{key:1,value:"connection ready"},{key:2,value:"connection is closing"},{key:3,value:"connection closed or error"}],gc=(o,t={})=>{let n=(0,ye.useRef)(null),s=(0,ye.useRef)(!0),[a,l]=(0,ye.useState)(0),[f,m]=(0,ye.useState)(""),[d,h]=(0,ye.useState)(""),[b,g]=(0,ye.useState)({key:0,value:"connecting"}),w=()=>{Wi(o,t).then(P=>{s.current&&m(P),n.current=new yc(P),n.current.onopen=A=>s.current&&g(xo[n.current?.readyState??0]),n.current.onclose=A=>{s.current&&g(xo[n.current?.readyState??0])},n.current.onerror=A=>{s.current&&g(xo[n.current?.readyState??0])},n.current.onmessage=A=>{s.current&&h(A.data.toString())}}).catch(se)},S=()=>{(!n.current||n.current.readyState===3)&&w()},y=()=>{n.current?.close()},T=()=>{s.current&&a<=10&&(console.log(`reconnect after ${a}s(${a}/10)`),ir(`Reconnect after ${a}s(${a}/10)`,""),Fi(a*1e3).then(()=>{console.log("reconnect"),s.current&&l(P=>P+1);try{y(),n.current=null,s.current&&w()}catch(P){ir("Websocket failed",P)}}))};return(0,ye.useEffect)(()=>(S(),()=>{n.current?.close(),s.current=!1}),[n]),{url:f,wsData:d,readyState:b,closeWebSocket:y,reconnect:T}},bn=gc;function Xa(){let[o,t]=(0,Be.useState)({up:0,down:0}),{url:n,wsData:s,readyState:a,reconnect:l}=bn("/traffic");return(0,Be.useEffect)(()=>{if(a.key===3&&l(),s){let f=JSON.parse(s);t(f)}},[s,a]),[n,o]}function yn(){let[o,t]=(0,Be.useState)({downloadTotal:0,uploadTotal:0,connections:[]}),{url:n,wsData:s,readyState:a,reconnect:l}=bn("/connections");return(0,Be.useEffect)(()=>{if(a.key===3&&l(),s){let f=JSON.parse(s);t(f)}},[s,a]),[n,o]}function Ja(o){let[t,n]=(0,Be.useState)([]),{url:s,wsData:a,readyState:l,reconnect:f,closeWebSocket:m}=bn("/logs",{level:o});return(0,Be.useEffect)(()=>{if(l.key===3&&f(),a){let d=JSON.parse(a);n(h=>[Ee(X({},d),{time:qi()}),...h])}},[a,l]),(0,Be.useEffect)(()=>{s&&(m(),f())},[o]),[s,t]}function Sc(o,t){return`${t.metadata.host?t.metadata.host:t.metadata.destinationIP}:${t.metadata.destinationPort}`}function wc(o,t){return o?`${t.chains.join(" / ")}`:`${t.rule}(${t.rulePayload})`}function Rc(o,t){return o?`${ze(t.download)}/s \u2193 ${ze(t.upload)}/s \u2191`:`${t.metadata.type}(${t.metadata.network})`}function Bo(){let[o,t]=yn(),[n,s]=(0,Ka.useState)(!0);return _jsx(lt.List,null,o?_jsx(_jsxFragment,null,_jsx(lt.List.Item,{key:-1,title:"Host",subtitle:n?"Chains":"Rules",accessoryTitle:`${n?"Overview":"Detail"} Mode`,actions:_jsx(lt.ActionPanel,null,_jsx(lt.ActionPanel.Item,{title:"Switch Mode",onAction:()=>{s(a=>!a)}}))}),t.connections.map((a,l)=>_jsx(lt.List.Item,{key:l,title:Sc(n,a),subtitle:wc(n,a),accessoryTitle:Rc(n,a)}))):_jsx(_jsxFragment,null))}var z=require("@raycast/api"),Za=require("react");var gn=["error","warning","info","debug"],Tc={debug:z.Color.Green,info:z.Color.Blue,warning:z.Color.Yellow,error:z.Color.Red};function Oo(){let[o,t]=(0,Za.useState)("info"),[n,s]=Ja(o);return _jsx(z.List,null,n?_jsx(_jsxFragment,null,_jsx(z.List.Item,{key:-1,title:"Time",subtitle:"Payload",accessoryTitle:`LogLevel(${o})`,actions:_jsx(z.ActionPanel,null,_jsx(z.Action,{title:"Swith Level",onAction:()=>{t(a=>{let l=gn.indexOf(a);return l>=gn.length-1?gn[0]:gn[l+1]})}}))}),s.map((a,l)=>_jsx(z.List.Item,{icon:{source:z.Icon.Circle,tintColor:Tc[a.type]},key:l,title:a.time?a.time:"",subtitle:a.payload,accessoryTitle:a.type,actions:_jsx(z.ActionPanel,null,_jsx(z.Action.Push,{title:"Show Detail",target:_jsx(z.Detail,{markdown:`\`\`\`
${a.payload}
\`\`\``})}))}))):_jsx(_jsxFragment,null))}var re=require("@raycast/api");function Lo(){let[o,t]=Xa(),[n,s]=yn();return _jsx(re.List,null,o&&n?_jsx(_jsxFragment,null,_jsx(re.List.Item,{key:"1",icon:re.Icon.ChevronUp,title:"Upload",accessoryTitle:`${ze(t.up)}/s`}),_jsx(re.List.Item,{key:"2",icon:re.Icon.ChevronDown,title:"Download",accessoryTitle:`${ze(t.down)}/s`}),_jsx(re.List.Item,{key:"3",icon:re.Icon.Upload,title:"Upload Total",accessoryTitle:`${ze(s.uploadTotal)}`}),_jsx(re.List.Item,{key:"4",icon:re.Icon.Download,title:"Download Total",accessoryTitle:`${ze(s.downloadTotal)}`}),_jsx(re.List.Item,{key:"5",icon:re.Icon.LevelMeter,title:"Active Connections",accessoryTitle:`${s.connections.length}`})):_jsx(_jsxFragment,null))}var ae=require("@raycast/api"),Ye=require("react");async function el(){return(await(await At({endpoint:"/proxies"})).json()).proxies}async function tl(){return(await(await At({endpoint:"/rules"})).json()).rules}async function rl(){return await(await At({endpoint:"/configs"})).json()}async function nl(o){let t=await At({endpoint:"/configs",method:"PATCH",body:o});if(t.status===400)throw new Error("Format error");if(t.status===404)throw new Error("Proxy not found");if(t.status!==204)throw new Error(`Unexpected status code: ${t.status}`)}async function ol(o,t){let n=await At({endpoint:`/proxies/${o}`,method:"PUT",body:{name:t}});if(n.status===400)throw new Error("Format error");if(n.status===404)throw new Error("Proxy not found");if(n.status!==204)throw new Error(`Unexpected status code: ${n.status}`)}function Ec({name:o,proxies:t,current:n,refresh:s,selectable:a}){let[l,f]=(0,Ye.useState)(n),[m,d]=(0,Ye.useState)(!1);return _jsx(ae.List,{isLoading:m},t.map((h,b)=>a?_jsx(ae.List.Item,{key:b,title:h,accessoryTitle:h==l?"Current":"",actions:_jsx(ae.ActionPanel,null,_jsx(ae.Action,{title:"Select",onAction:async()=>{try{d(!0),await ol(o,h),s(),f(h)}catch(g){se(g)}finally{d(!1)}}}))}):_jsx(ae.List.Item,{key:b,title:h,accessoryTitle:h==l?"Current":""})))}var Cc=["Selector","URLTest","Fallback","LoadBalance","Relay"];function Do(){let[o,t]=(0,Ye.useState)(!0),[n,s]=(0,Ye.useState)([]),[a,l]=(0,Ye.useState)(!1);return(0,Ye.useEffect)(()=>{(async()=>{try{t(!0);let m=await el(),d=[];for(let[b,g]of Object.entries(n))b==="GLOBAL"&&g.all&&(d=g.all);let h=Object.values(m).filter(({type:b})=>Cc.includes(b)).sort(({name:b},{name:g})=>d.indexOf(b)-d.indexOf(g));s(h)}catch(m){se(m)}finally{t(!1)}})()},[a]),_jsx(ae.List,{isLoading:o},n.map((f,m)=>_jsx(ae.List.Item,{key:m,title:f.name,subtitle:f.type,accessoryTitle:f.now,actions:_jsx(ae.ActionPanel,null,_jsx(ae.Action.Push,{title:"Show Proxies",target:_jsx(Ec,{name:f.name,proxies:f.all,current:f.now,refresh:()=>l(!a),selectable:f.type=="Selector"})}))})))}var br=require("@raycast/api"),Lt=require("react");var sl=["Domain","DomainSuffix","DomainKeyword","GeoIP","IPCIDR","SrcIPCIDR","SrcPort","DstPort","Process","ProcessPath","Match"];function Wo(){let[o,t]=(0,Lt.useState)(!0),[n,s]=(0,Lt.useState)([]),[a,l]=(0,Lt.useState)(sl[0]);return(0,Lt.useEffect)(()=>{(async()=>{try{t(!0);let m=await tl();s(m)}catch(m){se(m)}finally{t(!1)}})()},[]),_jsx(br.List,{isLoading:o,searchBarAccessory:_jsx(br.List.Dropdown,{tooltip:"Type",storeValue:!1,onChange:f=>l(f)},sl.map((f,m)=>_jsx(br.List.Dropdown.Item,{key:m,title:f,value:f})))},n.filter(f=>f.type===a).map((f,m)=>_jsx(br.List.Item,{key:m,title:f.payload,subtitle:f.type,accessoryTitle:f.proxy})))}var ut=require("@raycast/api"),Dt=require("react");var Pc=["rule","global","direct","script"];function Io(){let[o,t]=(0,Dt.useState)(!1),[n,s]=(0,Dt.useState)(""),[a,l]=(0,Dt.useState)(!1);return(0,Dt.useEffect)(()=>{(async()=>{try{t(!0);let m=await rl();s(m.mode)}catch(m){se(m)}finally{t(!1)}})()},[a]),_jsx(ut.List,{isLoading:o},Pc.map((f,m)=>_jsx(ut.List.Item,{key:m,title:Ni(f),accessoryTitle:f==n?"Current":"",actions:_jsx(ut.ActionPanel,null,_jsx(ut.Action,{title:"Select",onAction:async()=>{try{t(!0),await nl({mode:f}),l(!a)}catch(d){se(d)}finally{t(!1)}}}))})))}var Qe={Overview:Lo,Proxies:Do,Backends:ho,Conns:Bo,Rules:Wo,Logs:Oo,Mode:Io};var vc=[{title:"Overview",icon:"overview.png",node:_jsx(Qe.Overview,null)},{title:"Mode",icon:"mode.png",node:_jsx(Qe.Mode,null)},{title:"Proxies",icon:"proxies.png",node:_jsx(Qe.Proxies,null)},{title:"Rules",icon:"rules.png",node:_jsx(Qe.Rules,null)},{title:"Conns",icon:"conns.png",node:_jsx(Qe.Conns,null)},{title:"Logs",icon:"logs.png",node:_jsx(Qe.Logs,null)},{title:"Backends",icon:"backends.png",node:_jsx(Qe.Backends,null)}];function il(){return ln().catch(se),_jsx(ft.List,null,vc.map((o,t)=>_jsx(ft.List.Item,{key:t,title:o.title,icon:o.icon,actions:_jsx(ft.ActionPanel,null,_jsx(ft.Action.Push,{title:`Show ${o.title}`,target:o.node}))})))}module.exports=Nu(Ac);0&&(module.exports={});
/*! fetch-blob. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */
/*! formdata-polyfill. MIT License. Jimmy Wrting <https://jimmy.warting.se/opensource> */
